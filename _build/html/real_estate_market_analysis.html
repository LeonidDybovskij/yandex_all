
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Real estate market analysis in St. Petersburg &#8212; Data Science course</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'real_estate_market_analysis';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tariff statistics" href="tariff_stats.html" />
    <link rel="prev" title="Credit scoring" href="credit_scoring.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Data Science course</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Data Science course
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="credit_scoring.html">Credit scoring</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Real estate market analysis in St. Petersburg</a></li>
<li class="toctree-l1"><a class="reference internal" href="tariff_stats.html">Tariff statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="computer_games.html">Analysis of the computer games market</a></li>
<li class="toctree-l1"><a class="reference internal" href="tariff_recommendation.html">Tariff recommendation</a></li>
<li class="toctree-l1"><a class="reference internal" href="supervised_classification.html">Customer churn</a></li>
<li class="toctree-l1"><a class="reference internal" href="oil_bootstrap.html">Selection of a location for a well</a></li>
<li class="toctree-l1"><a class="reference internal" href="gold_recovery.html">Gold recovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_transformation.html">Protection of customers’ personal data</a></li>

<li class="toctree-l1"><a class="reference internal" href="cars_boosting.html">Cars cost determination</a></li>
<li class="toctree-l1"><a class="reference internal" href="taxi_time_series.html">Taxi orders prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="text_classification.html">Classification of comments</a></li>
<li class="toctree-l1"><a class="reference internal" href="computer_vision.html">Age prediction by photo</a></li>
<li class="toctree-l1"><a class="reference internal" href="regression_metallurgy.html">Steel temperature prediction</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/real_estate_market_analysis.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Real estate market analysis in St. Petersburg</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preprocessing">Data preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-description">Data description</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-values">Missing values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-data-types">Changing data types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#duplicates">Duplicates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#troubleshooting-abnormal-values">Troubleshooting abnormal values</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-categorization">Data categorization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploratory-data-analysis">Exploratory data analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meters">Meters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#price-of-the-object">Price of the object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#number-of-rooms">Number of rooms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ceiling-height">Ceiling height</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#apartment-floor">Apartment Floor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distances-to-objects">Distances to objects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advertisement-publication-date">Advertisement Publication Date</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#days-of-exposition">Days of exposition</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factors-affecting-pricing">Factors affecting pricing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#price-on-total-area">Price on total area</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#price-on-living-area">Price on living area</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#price-on-kitchen-area">Price on kitchen area</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#price-on-the-number-of-rooms">Price on the number of rooms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#price-by-floor-location">Price by floor location</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#price-and-time-of-placement">Price and time of placement</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#price-and-period-of-exposition">Price and period of exposition</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#average-price-per-square-meter">Average price per square meter</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#price-on-distance-to-the-center">Price on distance to the center</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">Conclusions</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="real-estate-market-analysis-in-st-petersburg">
<h1>Real estate market analysis in St. Petersburg<a class="headerlink" href="#real-estate-market-analysis-in-st-petersburg" title="Link to this heading">#</a></h1>
<p>Data is an archive of ads for apartments for sale in the Leningrad Oblast for several years (From Yandex.Real Estate).</p>
<p><strong>Research objectives</strong>:</p>
<ol class="arabic simple">
<li><p>To study the distribution of real estate objects according to a number of parameters</p></li>
<li><p>To identify the factors that affect the cost and time elapsed before the purchase of the apartment</p></li>
</ol>
<p><strong>Plan of work</strong>:</p>
<ol class="arabic simple">
<li><p>Describe the raw data to form an overall picture</p></li>
<li><p>Pre-process the data so that misssing values, duplicates and anomalies do not affect the statistics</p></li>
<li><p>Build data distributions by size, cost, location and other parameters (with categorization where necessary)</p></li>
<li><p>Examine the data on the time it takes to sell an apartment and identify the factors on which it may depend</p></li>
<li><p>Identify the factors that have the strongest influence on pricing in the Leningrad Oblast and St. Petersburg in particular</p></li>
<li><p>Summarize the results of the research</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">warnings</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">raw_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/datasets/real_estate_data.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">raw_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;real_estate_data.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">raw_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_images</th>
      <th>last_price</th>
      <th>total_area</th>
      <th>first_day_exposition</th>
      <th>rooms</th>
      <th>ceiling_height</th>
      <th>floors_total</th>
      <th>living_area</th>
      <th>floor</th>
      <th>is_apartment</th>
      <th>...</th>
      <th>kitchen_area</th>
      <th>balcony</th>
      <th>locality_name</th>
      <th>airports_nearest</th>
      <th>cityCenters_nearest</th>
      <th>parks_around3000</th>
      <th>parks_nearest</th>
      <th>ponds_around3000</th>
      <th>ponds_nearest</th>
      <th>days_exposition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>20</td>
      <td>13000000.0</td>
      <td>108.0</td>
      <td>2019-03-07T00:00:00</td>
      <td>3</td>
      <td>2.70</td>
      <td>16.0</td>
      <td>51.0</td>
      <td>8</td>
      <td>NaN</td>
      <td>...</td>
      <td>25.0</td>
      <td>NaN</td>
      <td>St. Petersburg</td>
      <td>18863.0</td>
      <td>16028.0</td>
      <td>1.0</td>
      <td>482.0</td>
      <td>2.0</td>
      <td>755.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7</td>
      <td>3350000.0</td>
      <td>40.4</td>
      <td>2018-12-04T00:00:00</td>
      <td>1</td>
      <td>NaN</td>
      <td>11.0</td>
      <td>18.6</td>
      <td>1</td>
      <td>NaN</td>
      <td>...</td>
      <td>11.0</td>
      <td>2.0</td>
      <td>Shushary settlement</td>
      <td>12817.0</td>
      <td>18603.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>81.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10</td>
      <td>5196000.0</td>
      <td>56.0</td>
      <td>2015-08-20T00:00:00</td>
      <td>2</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>34.3</td>
      <td>4</td>
      <td>NaN</td>
      <td>...</td>
      <td>8.3</td>
      <td>0.0</td>
      <td>St. Petersburg</td>
      <td>21741.0</td>
      <td>13933.0</td>
      <td>1.0</td>
      <td>90.0</td>
      <td>2.0</td>
      <td>574.0</td>
      <td>558.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>64900000.0</td>
      <td>159.0</td>
      <td>2015-07-24T00:00:00</td>
      <td>3</td>
      <td>NaN</td>
      <td>14.0</td>
      <td>NaN</td>
      <td>9</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>St. Petersburg</td>
      <td>28098.0</td>
      <td>6800.0</td>
      <td>2.0</td>
      <td>84.0</td>
      <td>3.0</td>
      <td>234.0</td>
      <td>424.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>10000000.0</td>
      <td>100.0</td>
      <td>2018-06-19T00:00:00</td>
      <td>2</td>
      <td>3.03</td>
      <td>14.0</td>
      <td>32.0</td>
      <td>13</td>
      <td>NaN</td>
      <td>...</td>
      <td>41.0</td>
      <td>NaN</td>
      <td>St. Petersburg</td>
      <td>31856.0</td>
      <td>8098.0</td>
      <td>2.0</td>
      <td>112.0</td>
      <td>1.0</td>
      <td>48.0</td>
      <td>121.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>airports_nearest — distance to the nearest airport in meters (m)</p></li>
<li><p>balcony — number of balconies</p></li>
<li><p>ceiling_height — ceiling height (m)</p></li>
<li><p>cityCenters_nearest — distance to the city center (m)</p></li>
<li><p>days_exposition — how many days the ad was placed (from publication to withdrawal)</p></li>
<li><p>first_day_exposition — publication date</p></li>
<li><p>floor — floor number</p></li>
<li><p>floors_total — total number of floors in the building</p></li>
<li><p>is_apartment — apartment (Boolean type)</p></li>
<li><p>kitchen_area — kitchen area in square meters (m²)</p></li>
<li><p>last_price — price at the time of withdrawal from publication</p></li>
<li><p>living_area — living area in square meters (m²)</p></li>
<li><p>locality_name — settlement name</p></li>
<li><p>open_plan — free layout (Boolean type)</p></li>
<li><p>parks_around3000 — тumber of parks within a 3 km radius</p></li>
<li><p>parks_nearest — distance to the nearest park (m)</p></li>
<li><p>ponds_around3000 — number of water bodies within a radius of 3 km</p></li>
<li><p>ponds_nearest — distance to the nearest body of water (m)</p></li>
<li><p>rooms — number of rooms</p></li>
<li><p>studio — studio apartment (Boolean type)</p></li>
<li><p>total_area — total floor area of the apartment in square meters (m²)</p></li>
<li><p>total_images — number of photos of the apartment in the advertisement</p></li>
</ul>
<p>It can be seen that for each apartment there are several types of area, each of which should be considered.</p>
<p>There are also a number of factors for which the distance is automatically calculated.</p>
<p>A large number of omissions are conspicuous.</p>
<section id="data-preprocessing">
<h2>Data preprocessing<a class="headerlink" href="#data-preprocessing" title="Link to this heading">#</a></h2>
<p>Let’s examine the gaps and repetitions in the data, and look at the overall statistics for the dataframe.</p>
<section id="data-description">
<h3>Data description<a class="headerlink" href="#data-description" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 23699 entries, 0 to 23698
Data columns (total 22 columns):
 #   Column                Non-Null Count  Dtype  
---  ------                --------------  -----  
 0   total_images          23699 non-null  int64  
 1   last_price            23699 non-null  float64
 2   total_area            23699 non-null  float64
 3   first_day_exposition  23699 non-null  object 
 4   rooms                 23699 non-null  int64  
 5   ceiling_height        14504 non-null  float64
 6   floors_total          23613 non-null  float64
 7   living_area           21796 non-null  float64
 8   floor                 23699 non-null  int64  
 9   is_apartment          2775 non-null   object 
 10  studio                23699 non-null  bool   
 11  open_plan             23699 non-null  bool   
 12  kitchen_area          21421 non-null  float64
 13  balcony               12180 non-null  float64
 14  locality_name         23650 non-null  object 
 15  airports_nearest      18157 non-null  float64
 16  cityCenters_nearest   18180 non-null  float64
 17  parks_around3000      18181 non-null  float64
 18  parks_nearest         8079 non-null   float64
 19  ponds_around3000      18181 non-null  float64
 20  ponds_nearest         9110 non-null   float64
 21  days_exposition       20518 non-null  float64
dtypes: bool(2), float64(14), int64(3), object(3)
memory usage: 3.7+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="s1">&#39;is_apartment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="s1">&#39;balcony&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="s1">&#39;rooms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="s1">&#39;locality_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[nan False True]
[nan  2.  0.  1.  5.  4.  3.]
[ 3  1  2  4  5  6  0  7 11  8 14 10 15  9 19 16 12]
329
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">raw_data</span><span class="p">[[</span>
    <span class="s1">&#39;last_price&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;total_area&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;rooms&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;floor&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;cityCenters_nearest&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;days_exposition&#39;</span><span class="p">]]</span>
 <span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>last_price</th>
      <th>total_area</th>
      <th>rooms</th>
      <th>floor</th>
      <th>cityCenters_nearest</th>
      <th>days_exposition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2.369900e+04</td>
      <td>23699.000000</td>
      <td>23699.000000</td>
      <td>23699.000000</td>
      <td>18180.000000</td>
      <td>20518.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>6.541549e+06</td>
      <td>60.348651</td>
      <td>2.070636</td>
      <td>5.892358</td>
      <td>14191.277833</td>
      <td>180.888634</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.088701e+07</td>
      <td>35.654083</td>
      <td>1.078405</td>
      <td>4.885249</td>
      <td>8608.386210</td>
      <td>219.727988</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.219000e+04</td>
      <td>12.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>181.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>3.400000e+06</td>
      <td>40.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>9238.000000</td>
      <td>45.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>4.650000e+06</td>
      <td>52.000000</td>
      <td>2.000000</td>
      <td>4.000000</td>
      <td>13098.500000</td>
      <td>95.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>6.800000e+06</td>
      <td>69.900000</td>
      <td>3.000000</td>
      <td>8.000000</td>
      <td>16293.000000</td>
      <td>232.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>7.630000e+08</td>
      <td>900.000000</td>
      <td>19.000000</td>
      <td>33.000000</td>
      <td>65968.000000</td>
      <td>1580.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">raw_data</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1f83a14013e26c1f7d583bf5b45e9328ee71181309a619b1d1ed6cb255572229.png" src="_images/1f83a14013e26c1f7d583bf5b45e9328ee71181309a619b1d1ed6cb255572229.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_data</span><span class="p">[</span><span class="s1">&#39;total_images&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10    1798
9     1725
20    1694
8     1585
7     1521
Name: total_images, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>The abrupt cliff after 20 photos is interesting. Probably some kind of a site limit.</p>
<p>There are noticeable outliers in prices, meters, number of rooms and ceiling heights. It is not very clear yet whether this is a mistake or expensive real estate.</p>
</section>
<section id="missing-values">
<h3>Missing values<a class="headerlink" href="#missing-values" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>total_images                0
last_price                  0
total_area                  0
first_day_exposition        0
rooms                       0
ceiling_height           9195
floors_total               86
living_area              1903
floor                       0
is_apartment            20924
studio                      0
open_plan                   0
kitchen_area             2278
balcony                 11519
locality_name              49
airports_nearest         5542
cityCenters_nearest      5519
parks_around3000         5518
parks_nearest           15620
ponds_around3000         5518
ponds_nearest           14589
days_exposition          3181
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">raw_data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">,))</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="s1">&#39;OrRd&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
#T_a65ce_row0_col0,#T_a65ce_row1_col0,#T_a65ce_row2_col0,#T_a65ce_row3_col0,#T_a65ce_row4_col0,#T_a65ce_row6_col0,#T_a65ce_row8_col0,#T_a65ce_row10_col0,#T_a65ce_row11_col0,#T_a65ce_row14_col0{
            background-color:  #fff7ec;
            color:  #000000;
        }#T_a65ce_row5_col0{
            background-color:  #fca26d;
            color:  #000000;
        }#T_a65ce_row7_col0{
            background-color:  #feecd2;
            color:  #000000;
        }#T_a65ce_row9_col0{
            background-color:  #7f0000;
            color:  #f1f1f1;
        }#T_a65ce_row12_col0{
            background-color:  #fee9cb;
            color:  #000000;
        }#T_a65ce_row13_col0{
            background-color:  #f67b51;
            color:  #000000;
        }#T_a65ce_row15_col0,#T_a65ce_row16_col0,#T_a65ce_row17_col0,#T_a65ce_row19_col0{
            background-color:  #fdd29c;
            color:  #000000;
        }#T_a65ce_row18_col0{
            background-color:  #d62f1e;
            color:  #f1f1f1;
        }#T_a65ce_row20_col0{
            background-color:  #df432d;
            color:  #f1f1f1;
        }#T_a65ce_row21_col0{
            background-color:  #fee5c1;
            color:  #000000;
        }</style><table id="T_a65ce_" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >0</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_a65ce_level0_row0" class="row_heading level0 row0" >total_images</th>
                        <td id="T_a65ce_row0_col0" class="data row0 col0" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row1" class="row_heading level0 row1" >last_price</th>
                        <td id="T_a65ce_row1_col0" class="data row1 col0" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row2" class="row_heading level0 row2" >total_area</th>
                        <td id="T_a65ce_row2_col0" class="data row2 col0" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row3" class="row_heading level0 row3" >first_day_exposition</th>
                        <td id="T_a65ce_row3_col0" class="data row3 col0" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row4" class="row_heading level0 row4" >rooms</th>
                        <td id="T_a65ce_row4_col0" class="data row4 col0" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row5" class="row_heading level0 row5" >ceiling_height</th>
                        <td id="T_a65ce_row5_col0" class="data row5 col0" >39.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row6" class="row_heading level0 row6" >floors_total</th>
                        <td id="T_a65ce_row6_col0" class="data row6 col0" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row7" class="row_heading level0 row7" >living_area</th>
                        <td id="T_a65ce_row7_col0" class="data row7 col0" >8.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row8" class="row_heading level0 row8" >floor</th>
                        <td id="T_a65ce_row8_col0" class="data row8 col0" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row9" class="row_heading level0 row9" >is_apartment</th>
                        <td id="T_a65ce_row9_col0" class="data row9 col0" >88.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row10" class="row_heading level0 row10" >studio</th>
                        <td id="T_a65ce_row10_col0" class="data row10 col0" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row11" class="row_heading level0 row11" >open_plan</th>
                        <td id="T_a65ce_row11_col0" class="data row11 col0" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row12" class="row_heading level0 row12" >kitchen_area</th>
                        <td id="T_a65ce_row12_col0" class="data row12 col0" >10.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row13" class="row_heading level0 row13" >balcony</th>
                        <td id="T_a65ce_row13_col0" class="data row13 col0" >49.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row14" class="row_heading level0 row14" >locality_name</th>
                        <td id="T_a65ce_row14_col0" class="data row14 col0" >0.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row15" class="row_heading level0 row15" >airports_nearest</th>
                        <td id="T_a65ce_row15_col0" class="data row15 col0" >23.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row16" class="row_heading level0 row16" >cityCenters_nearest</th>
                        <td id="T_a65ce_row16_col0" class="data row16 col0" >23.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row17" class="row_heading level0 row17" >parks_around3000</th>
                        <td id="T_a65ce_row17_col0" class="data row17 col0" >23.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row18" class="row_heading level0 row18" >parks_nearest</th>
                        <td id="T_a65ce_row18_col0" class="data row18 col0" >66.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row19" class="row_heading level0 row19" >ponds_around3000</th>
                        <td id="T_a65ce_row19_col0" class="data row19 col0" >23.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row20" class="row_heading level0 row20" >ponds_nearest</th>
                        <td id="T_a65ce_row20_col0" class="data row20 col0" >62.000000</td>
            </tr>
            <tr>
                        <th id="T_a65ce_level0_row21" class="row_heading level0 row21" >days_exposition</th>
                        <td id="T_a65ce_row21_col0" class="data row21 col0" >13.000000</td>
            </tr>
    </tbody></table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">raw_data</span><span class="p">[</span><span class="s1">&#39;locality_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_images</th>
      <th>last_price</th>
      <th>total_area</th>
      <th>first_day_exposition</th>
      <th>rooms</th>
      <th>ceiling_height</th>
      <th>floors_total</th>
      <th>living_area</th>
      <th>floor</th>
      <th>is_apartment</th>
      <th>...</th>
      <th>kitchen_area</th>
      <th>balcony</th>
      <th>locality_name</th>
      <th>airports_nearest</th>
      <th>cityCenters_nearest</th>
      <th>parks_around3000</th>
      <th>parks_nearest</th>
      <th>ponds_around3000</th>
      <th>ponds_nearest</th>
      <th>days_exposition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1097</th>
      <td>3</td>
      <td>8600000.0</td>
      <td>81.7</td>
      <td>2016-04-15T00:00:00</td>
      <td>3</td>
      <td>3.55</td>
      <td>5.0</td>
      <td>50.8</td>
      <td>2</td>
      <td>NaN</td>
      <td>...</td>
      <td>8.8</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>23478.0</td>
      <td>4258.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>147.0</td>
    </tr>
    <tr>
      <th>2033</th>
      <td>6</td>
      <td>5398000.0</td>
      <td>80.0</td>
      <td>2017-05-30T00:00:00</td>
      <td>3</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>42.6</td>
      <td>2</td>
      <td>NaN</td>
      <td>...</td>
      <td>18.6</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>34.0</td>
    </tr>
    <tr>
      <th>2603</th>
      <td>20</td>
      <td>3351765.0</td>
      <td>42.7</td>
      <td>2015-09-20T00:00:00</td>
      <td>1</td>
      <td>NaN</td>
      <td>24.0</td>
      <td>15.6</td>
      <td>3</td>
      <td>NaN</td>
      <td>...</td>
      <td>10.7</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>22041.0</td>
      <td>17369.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>374.0</td>
      <td>276.0</td>
    </tr>
    <tr>
      <th>2632</th>
      <td>2</td>
      <td>5130593.0</td>
      <td>62.4</td>
      <td>2015-10-11T00:00:00</td>
      <td>2</td>
      <td>NaN</td>
      <td>24.0</td>
      <td>33.1</td>
      <td>21</td>
      <td>NaN</td>
      <td>...</td>
      <td>8.2</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>22041.0</td>
      <td>17369.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>374.0</td>
      <td>256.0</td>
    </tr>
    <tr>
      <th>3574</th>
      <td>10</td>
      <td>4200000.0</td>
      <td>46.5</td>
      <td>2016-05-28T00:00:00</td>
      <td>2</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>30.8</td>
      <td>5</td>
      <td>NaN</td>
      <td>...</td>
      <td>6.5</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>27419.0</td>
      <td>8127.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>603.0</td>
      <td>45.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">raw_data</span><span class="p">[</span><span class="s1">&#39;floors_total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_images</th>
      <th>last_price</th>
      <th>total_area</th>
      <th>first_day_exposition</th>
      <th>rooms</th>
      <th>ceiling_height</th>
      <th>floors_total</th>
      <th>living_area</th>
      <th>floor</th>
      <th>is_apartment</th>
      <th>...</th>
      <th>kitchen_area</th>
      <th>balcony</th>
      <th>locality_name</th>
      <th>airports_nearest</th>
      <th>cityCenters_nearest</th>
      <th>parks_around3000</th>
      <th>parks_nearest</th>
      <th>ponds_around3000</th>
      <th>ponds_nearest</th>
      <th>days_exposition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>186</th>
      <td>12</td>
      <td>11640000.0</td>
      <td>65.2</td>
      <td>2018-10-02T00:00:00</td>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>30.80</td>
      <td>4</td>
      <td>NaN</td>
      <td>...</td>
      <td>12.00</td>
      <td>NaN</td>
      <td>St. Petersburg</td>
      <td>39197.0</td>
      <td>12373.0</td>
      <td>1.0</td>
      <td>123.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>49.0</td>
    </tr>
    <tr>
      <th>237</th>
      <td>4</td>
      <td>2438033.0</td>
      <td>28.1</td>
      <td>2016-11-23T00:00:00</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>20.75</td>
      <td>1</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>St. Petersburg</td>
      <td>22041.0</td>
      <td>17369.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>374.0</td>
      <td>251.0</td>
    </tr>
    <tr>
      <th>457</th>
      <td>4</td>
      <td>9788348.0</td>
      <td>70.8</td>
      <td>2015-08-01T00:00:00</td>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>38.40</td>
      <td>12</td>
      <td>NaN</td>
      <td>...</td>
      <td>10.63</td>
      <td>0.0</td>
      <td>St. Petersburg</td>
      <td>37364.0</td>
      <td>8322.0</td>
      <td>2.0</td>
      <td>309.0</td>
      <td>2.0</td>
      <td>706.0</td>
      <td>727.0</td>
    </tr>
    <tr>
      <th>671</th>
      <td>4</td>
      <td>6051191.0</td>
      <td>93.6</td>
      <td>2017-04-06T00:00:00</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>47.10</td>
      <td>8</td>
      <td>NaN</td>
      <td>...</td>
      <td>16.80</td>
      <td>0.0</td>
      <td>St. Petersburg</td>
      <td>22041.0</td>
      <td>17369.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>374.0</td>
      <td>123.0</td>
    </tr>
    <tr>
      <th>1757</th>
      <td>5</td>
      <td>3600000.0</td>
      <td>39.0</td>
      <td>2017-04-22T00:00:00</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>St. Petersburg</td>
      <td>22735.0</td>
      <td>11618.0</td>
      <td>1.0</td>
      <td>835.0</td>
      <td>1.0</td>
      <td>652.0</td>
      <td>77.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div></div>
</div>
<p>Doesn’t look like errors, but we’ll discard the lines with those skips anyway.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="s1">&#39;ceiling_height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="s1">&#39;ceiling_height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.50     3515
2.60     1646
2.70     1574
3.00     1112
2.80      993
         ... 
4.25        1
3.39        1
3.93        1
10.30       1
4.65        1
Name: ceiling_height, Length: 183, dtype: int64
1.00       1
1.20       1
1.75       1
2.00      11
2.20       1
          ..
26.00      1
27.00      8
27.50      1
32.00      2
100.00     1
Name: ceiling_height, Length: 183, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">raw_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># to avoid changing the original dataframe during the analysis process</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ceiling_height</span></code> – large data set, which is unreasonable to get rid of; at the same time, there are only few outliers, so the median makes no specific sense; let’s <strong>replace with arithmetic mean</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_ceiling_height</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ceiling_height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;ceiling_height&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ceiling_height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mean_ceiling_height</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">floors_total</span></code> – these skips are not very numerous, and the fact of purchase is significantly affected by this factor; let’s <strong>throw them out</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;floors_total&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">living_area</span></code> – an important factor in the calculations, but almost 2000 lines; let’s <strong>leave them in the data</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">is_apartment</span></code> – a large number of gaps, which should be replaced either by “unknown” strings or False values; let’s <strong>replace them with “unknown”</strong> (True and False should also be changed to Yes and No for homogeneity).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;is_apartment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;is_apartment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;unknown&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;is_apartment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;is_apartment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="kc">True</span><span class="p">:</span> <span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s1">&#39;No&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">kitchen_area</span></code> – an important parameter, let’s <strong>replace by median</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;kitchen_area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;kitchen_area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;kitchen_area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">balcony</span></code> – if a balcony is not specified, it is likely not present; let’s <strong>replace with zeros</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;balcony&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;balcony&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">locality_name</span></code> – a necessary factor for statistics, but there are only few of them; let’s <strong>throw them out</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;locality_name&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">airports_nearest</span></code> – distance to the nearest airport is not a significant factor; let’s <strong>replace with median</strong> (preferably an integer)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;airports_nearest&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;airports_nearest&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;airports_nearest&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">cityCenters_nearest</span></code> – more important than airports, let’s <strong>replace with medians within settlements</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;cityCenters_nearest&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span>
                               <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;locality_name&#39;</span><span class="p">)[</span><span class="s1">&#39;cityCenters_nearest&#39;</span><span class="p">]</span>
                               <span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">median</span><span class="p">())))</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">parks_around3000</span></code> - parks are a benefit, if they are not specified then they are not there; <strong>replace with zeros</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;parks_around3000&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;parks_around3000&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">parks_nearest</span></code> - similarly; <strong>replace with medians within settlements</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># warnings.filterwarnings(&#39;ignore&#39;, category=RuntimeWarning)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;parks_nearest&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span>
                         <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;locality_name&#39;</span><span class="p">)[</span><span class="s1">&#39;parks_nearest&#39;</span><span class="p">]</span>
                         <span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">median</span><span class="p">())))</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ponds_around3000</span></code> - similar to parks; <strong>replace with zeros</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ponds_around3000&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ponds_around3000&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ponds_nearest</span></code> - similar to parks; <strong>replace with medians within settlements</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># warnings.filterwarnings(&#39;ignore&#39;, category=RuntimeWarning)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;ponds_nearest&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span>
                         <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;locality_name&#39;</span><span class="p">)[</span><span class="s1">&#39;ponds_nearest&#39;</span><span class="p">]</span>
                         <span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">median</span><span class="p">())))</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">days_exposition</span></code> – factor necessary for calculations, more than 3000 lines, let’s <strong>leave them in data</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;cityCenters_nearest&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_images</th>
      <th>last_price</th>
      <th>total_area</th>
      <th>first_day_exposition</th>
      <th>rooms</th>
      <th>ceiling_height</th>
      <th>floors_total</th>
      <th>living_area</th>
      <th>floor</th>
      <th>is_apartment</th>
      <th>...</th>
      <th>kitchen_area</th>
      <th>balcony</th>
      <th>locality_name</th>
      <th>airports_nearest</th>
      <th>cityCenters_nearest</th>
      <th>parks_around3000</th>
      <th>parks_nearest</th>
      <th>ponds_around3000</th>
      <th>ponds_nearest</th>
      <th>days_exposition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>10</td>
      <td>2890000.0</td>
      <td>30.40</td>
      <td>2018-09-10T00:00:00</td>
      <td>1</td>
      <td>2.771499</td>
      <td>12.0</td>
      <td>14.40</td>
      <td>5</td>
      <td>unknown</td>
      <td>...</td>
      <td>9.10</td>
      <td>0.0</td>
      <td>Yanino-1 urban settlement</td>
      <td>26757.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>20</td>
      <td>2900000.0</td>
      <td>33.16</td>
      <td>2018-05-23T00:00:00</td>
      <td>1</td>
      <td>2.771499</td>
      <td>27.0</td>
      <td>15.43</td>
      <td>26</td>
      <td>unknown</td>
      <td>...</td>
      <td>8.81</td>
      <td>0.0</td>
      <td>Murino settlement</td>
      <td>26757.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>189.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>10</td>
      <td>3890000.0</td>
      <td>54.00</td>
      <td>2016-06-30T00:00:00</td>
      <td>2</td>
      <td>2.771499</td>
      <td>5.0</td>
      <td>30.00</td>
      <td>5</td>
      <td>unknown</td>
      <td>...</td>
      <td>9.00</td>
      <td>0.0</td>
      <td>Sertolovo</td>
      <td>26757.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>90.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>20</td>
      <td>5000000.0</td>
      <td>58.00</td>
      <td>2017-04-24T00:00:00</td>
      <td>2</td>
      <td>2.750000</td>
      <td>25.0</td>
      <td>30.00</td>
      <td>15</td>
      <td>unknown</td>
      <td>...</td>
      <td>11.00</td>
      <td>2.0</td>
      <td>Kudrovo village</td>
      <td>26757.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>30</th>
      <td>12</td>
      <td>2200000.0</td>
      <td>32.80</td>
      <td>2018-02-19T00:00:00</td>
      <td>1</td>
      <td>2.771499</td>
      <td>9.0</td>
      <td>NaN</td>
      <td>2</td>
      <td>unknown</td>
      <td>...</td>
      <td>9.10</td>
      <td>0.0</td>
      <td>Kommunar</td>
      <td>26757.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>63.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div></div>
</div>
<p>Apparently, it is the location of the apartment itself that is not given for these skips.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data.query(&#39;locality_name == &quot;городской посёлок Янино-1&quot;&#39;)</span>
</pre></div>
</div>
</div>
</div>
<p>Perhaps the exact location is not given in small villages. This is not a problem for buyers, because in villages, parks and ponds are rarely of interest.</p>
<ul class="simple">
<li><p>It is not possible to replace these missing values with zero, because it does not reflect reality and may affect the process of searching for relationships of features.</p></li>
<li><p>Replacing them with the value “unknown” is also not a good option, because there are numbers in other rows with which arithmetic operations will be necessary.</p></li>
<li><p>It is definitely impossible to throw out these lines: the data on whole villages will be lost.</p></li>
</ul>
<p>We will have to leave them as they are.</p>
<p>I should note that the method above has still removed some of the skips. Apparently, for large cities where it was possible.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>total_images               0
last_price                 0
total_area                 0
first_day_exposition       0
rooms                      0
ceiling_height             0
floors_total               0
living_area             1865
floor                      0
is_apartment               0
studio                     0
open_plan                  0
kitchen_area               0
balcony                    0
locality_name              0
airports_nearest           0
cityCenters_nearest     5432
parks_around3000           0
parks_nearest           5986
ponds_around3000           0
ponds_nearest           5517
days_exposition         3171
dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="changing-data-types">
<h3>Changing data types<a class="headerlink" href="#changing-data-types" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 23565 entries, 0 to 23698
Data columns (total 22 columns):
 #   Column                Non-Null Count  Dtype  
---  ------                --------------  -----  
 0   total_images          23565 non-null  int64  
 1   last_price            23565 non-null  float64
 2   total_area            23565 non-null  float64
 3   first_day_exposition  23565 non-null  object 
 4   rooms                 23565 non-null  int64  
 5   ceiling_height        23565 non-null  float64
 6   floors_total          23565 non-null  float64
 7   living_area           21700 non-null  float64
 8   floor                 23565 non-null  int64  
 9   is_apartment          23565 non-null  object 
 10  studio                23565 non-null  bool   
 11  open_plan             23565 non-null  bool   
 12  kitchen_area          23565 non-null  float64
 13  balcony               23565 non-null  float64
 14  locality_name         23565 non-null  object 
 15  airports_nearest      23565 non-null  float64
 16  cityCenters_nearest   18133 non-null  float64
 17  parks_around3000      23565 non-null  float64
 18  parks_nearest         17579 non-null  float64
 19  ponds_around3000      23565 non-null  float64
 20  ponds_nearest         18048 non-null  float64
 21  days_exposition       20394 non-null  float64
dtypes: bool(2), float64(14), int64(3), object(3)
memory usage: 3.8+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Real estate prices are usually quoted without cents</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;last_price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;last_price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ceiling heights will need to be cathegrized, accuracy is redundant here</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;ceiling_height&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ceiling_height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">decimals</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here the fractional number was caused by the presence of NaNs</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;floors_total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;floors_total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Similar case</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;balcony&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;balcony&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Identical fractional numbers may not be equal to each other, so they should be converted to integers for bar charts</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;parks_around3000&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;parks_around3000&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;ponds_around3000&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ponds_around3000&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span> <span class="c1"># For diversity</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_images</th>
      <th>last_price</th>
      <th>total_area</th>
      <th>first_day_exposition</th>
      <th>rooms</th>
      <th>ceiling_height</th>
      <th>floors_total</th>
      <th>living_area</th>
      <th>floor</th>
      <th>is_apartment</th>
      <th>...</th>
      <th>kitchen_area</th>
      <th>balcony</th>
      <th>locality_name</th>
      <th>airports_nearest</th>
      <th>cityCenters_nearest</th>
      <th>parks_around3000</th>
      <th>parks_nearest</th>
      <th>ponds_around3000</th>
      <th>ponds_nearest</th>
      <th>days_exposition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>23694</th>
      <td>9</td>
      <td>9700000</td>
      <td>133.81</td>
      <td>2017-03-21T00:00:00</td>
      <td>3</td>
      <td>3.7</td>
      <td>5</td>
      <td>73.3</td>
      <td>3</td>
      <td>unknown</td>
      <td>...</td>
      <td>13.83</td>
      <td>0</td>
      <td>St. Petersburg</td>
      <td>24665.0</td>
      <td>4232.0</td>
      <td>1</td>
      <td>796.0</td>
      <td>3</td>
      <td>381.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>23695</th>
      <td>14</td>
      <td>3100000</td>
      <td>59.00</td>
      <td>2018-01-15T00:00:00</td>
      <td>3</td>
      <td>2.8</td>
      <td>5</td>
      <td>38.0</td>
      <td>4</td>
      <td>unknown</td>
      <td>...</td>
      <td>8.50</td>
      <td>0</td>
      <td>Tosno</td>
      <td>26757.0</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>45.0</td>
    </tr>
    <tr>
      <th>23696</th>
      <td>18</td>
      <td>2500000</td>
      <td>56.70</td>
      <td>2018-02-11T00:00:00</td>
      <td>2</td>
      <td>2.8</td>
      <td>3</td>
      <td>29.7</td>
      <td>1</td>
      <td>unknown</td>
      <td>...</td>
      <td>9.10</td>
      <td>0</td>
      <td>Rozhdestrovo village</td>
      <td>26757.0</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>23697</th>
      <td>13</td>
      <td>11475000</td>
      <td>76.75</td>
      <td>2017-03-28T00:00:00</td>
      <td>2</td>
      <td>3.0</td>
      <td>17</td>
      <td>NaN</td>
      <td>12</td>
      <td>unknown</td>
      <td>...</td>
      <td>23.30</td>
      <td>2</td>
      <td>St. Petersburg</td>
      <td>39140.0</td>
      <td>10364.0</td>
      <td>2</td>
      <td>173.0</td>
      <td>3</td>
      <td>196.0</td>
      <td>602.0</td>
    </tr>
    <tr>
      <th>23698</th>
      <td>4</td>
      <td>1350000</td>
      <td>32.30</td>
      <td>2017-07-21T00:00:00</td>
      <td>1</td>
      <td>2.5</td>
      <td>5</td>
      <td>12.3</td>
      <td>1</td>
      <td>unknown</td>
      <td>...</td>
      <td>9.00</td>
      <td>0</td>
      <td>Novy Uchkhoz settlement</td>
      <td>26757.0</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div></div>
</div>
</section>
<section id="duplicates">
<h3>Duplicates<a class="headerlink" href="#duplicates" title="Link to this heading">#</a></h3>
<p>Let’s eliminate implicit duplicates:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sorted(data[&#39;locality_name&#39;].unique(), key=lambda x: x[::-1]) for the sorting from the end</span>
<span class="n">settlements</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;locality_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">settlements</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Agalatovo village&#39;,
 &#39;Alekseevka settlement&#39;,
 &#39;Alexandrovskaya settlement&#39;,
 &#39;Annino settlement&#39;,
 &#39;Aro village&#39;,
 &#39;Baryshevo settlement&#39;,
 &#39;Batovo village&#39;,
 &#39;Begunitsy village&#39;,
 &#39;Belogorka village&#39;,
 &#39;Beloostrov settlement&#39;,
 &#39;Boksitogorsk&#39;,
 &#39;Bolshaya Izhora urban settlement&#39;,
 &#39;Bolshaya Izhora urban-type settlement&#39;,
 &#39;Bolshaya Pustomierzha village&#39;,
 &#39;Bolshaya Vruda village&#39;,
 &#39;Bolshee Kolpany village&#39;,
 &#39;Bolshoy Sabsk village&#39;,
 &#39;Bolshoye Reizino village&#39;,
 &#39;Bor village&#39;,
 &#39;Borisova Griva village&#39;,
 &#39;Budogoshch urban settlement&#39;,
 &#39;Bugry settlement&#39;,
 &#39;Chudskoy Bor village&#39;,
 &#39;Druzhnaya Gorka urban-type settlement&#39;,
 &#39;Druznoselye village&#39;,
 &#39;Dubrovka urban-type settlement&#39;,
 &#39;Dzerzhinsky settlement&#39;,
 &#39;Efimovsky urban-type settlement&#39;,
 &#39;Elizavetino settlement&#39;,
 &#39;Falileevo village&#39;,
 &#39;Fedorovskoye urban settlement&#39;,
 &#39;Fedorovskoye village&#39;,
 &#39;Fornosovo urban-type settlement&#39;,
 &#39;Fort Krasnaya Gorka village&#39;,
 &#39;Garbolovo settlement&#39;,
 &#39;Garbolovo village&#39;,
 &#39;Gatchina&#39;,
 &#39;Gavrilovo settlement&#39;,
 &#39;Ghorbunki village&#39;,
 &#39;Gladkoe settlement&#39;,
 &#39;Glass village&#39;,
 &#39;Glazhevo settlement&#39;,
 &#39;Glebychevo settlement&#39;,
 &#39;Glinka village&#39;,
 &#39;Goncharovo settlement&#39;,
 &#39;Gostilitsy village&#39;,
 &#39;Gromovo settlement&#39;,
 &#39;Gromovo station settlement&#39;,
 &#39;Ilyichevo village&#39;,
 &#39;Issad village&#39;,
 &#39;Ivangorod&#39;,
 &#39;Izvara village&#39;,
 &#39;Kalitino settlement&#39;,
 &#39;Kalitino village&#39;,
 &#39;Kalozhitsy settlement&#39;,
 &#39;Kaltino village&#39;,
 &#39;Kamennogorsk&#39;,
 &#39;Kamyshovka village&#39;,
 &#39;Kaskovo village&#39;,
 &#39;Kelozi village&#39;,
 &#39;Khapo-Oe village&#39;,
 &#39;Khyazelki village&#39;,
 &#39;Kikerino settlement&#39;,
 &#39;Kingisepp&#39;,
 &#39;Kingiseppsky settlement&#39;,
 &#39;Kipen village&#39;,
 &#39;Kirishi&#39;,
 &#39;Kirovsk&#39;,
 &#39;Kirpichnoye settlement&#39;,
 &#39;Kiselnya village&#39;,
 &#39;Kivennapa North cottage settlement&#39;,
 &#39;Kobralovo settlement&#39;,
 &#39;Kobrinskoye settlement&#39;,
 &#39;Kolpino&#39;,
 &#39;Koltushi village&#39;,
 &#39;Kommunar&#39;,
 &#39;Kommunary settlement&#39;,
 &#39;Kondratievo urban-type settlement&#39;,
 &#39;Koporie village&#39;,
 &#39;Korkino village&#39;,
 &#39;Kornevo station settlement&#39;,
 &#39;Korobitsyno village&#39;,
 &#39;Kotelsky settlement&#39;,
 &#39;Kotly village&#39;,
 &#39;Krasnaya Dolina settlement&#39;,
 &#39;Krasnoselskoe settlement&#39;,
 &#39;Krasnoye Selo&#39;,
 &#39;Krasny Bor urban-type settlement&#39;,
 &#39;Krivko village&#39;,
 &#39;Kronstadt&#39;,
 &#39;Kudrovo&#39;,
 &#39;Kudrovo village&#39;,
 &#39;Kurkovitsy village&#39;,
 &#39;Kurovitsy village&#39;,
 &#39;Kuttuzi village&#39;,
 &#39;Kuzmolovo village&#39;,
 &#39;Kuzmolovsky urban-type settlement&#39;,
 &#39;Kuznechnoye urban settlement&#39;,
 &#39;Lagolovo village&#39;,
 &#39;Lampovo village&#39;,
 &#39;Lavriki village&#39;,
 &#39;Lebyazhie urban-type settlement&#39;,
 &#39;Leninskoye village&#39;,
 &#39;Leskolovo village&#39;,
 &#39;Lesnaya Polyana garden non-profit partnership&#39;,
 &#39;Lesnoye cottage settlement&#39;,
 &#39;Lesnoye village&#39;,
 &#39;Lesogorsky urban settlement&#39;,
 &#39;Lesogorsky urban-type settlement&#39;,
 &#39;Levashovo settlement&#39;,
 &#39;Lisiy Nos settlement&#39;,
 &#39;Lodeynoye Pole&#39;,
 &#39;Lomonosov&#39;,
 &#39;Lopukhinka village&#39;,
 &#39;Luban&#39;,
 &#39;Luban settlement&#39;,
 &#39;Luga&#39;,
 &#39;Lukashi settlement&#39;,
 &#39;Luppolovo village&#39;,
 &#39;Luzhaika station settlement&#39;,
 &#39;Malaya Romanovka village&#39;,
 &#39;Maloe Karlino village&#39;,
 &#39;Maloye Verevo village&#39;,
 &#39;Malye Kolpany village&#39;,
 &#39;Manuilovo village&#39;,
 &#39;Melnikovo settlement&#39;,
 &#39;Menkovo village&#39;,
 &#39;Metallostroy settlement&#39;,
 &#39;Mga urban settlement&#39;,
 &#39;Mga urban-type settlement&#39;,
 &#39;Michurinskoye settlement&#39;,
 &#39;Miny village&#39;,
 &#39;Mistolovo village&#39;,
 &#39;Molodezhnoye settlement&#39;,
 &#39;Molodtsovo settlement&#39;,
 &#39;Morozov urban-type settlement&#39;,
 &#39;Murino&#39;,
 &#39;Murino settlement&#39;,
 &#39;Myza-Ivanovka settlement&#39;,
 &#39;Nazia urban settlement&#39;,
 &#39;Nazia urban-type settlement&#39;,
 &#39;Nenimyaki village&#39;,
 &#39;Nikolskoye&#39;,
 &#39;Nikolskoye village&#39;,
 &#39;Nikolsky urban-type settlement&#39;,
 &#39;Nizhnie Oselki village&#39;,
 &#39;Nizhnyaya village&#39;,
 &#39;Nizino village&#39;,
 &#39;Novaya Ladoga&#39;,
 &#39;Novaya Ropsha garden community&#39;,
 &#39;Novogorelovo settlement&#39;,
 &#39;Novolisino village&#39;,
 &#39;Novoselye urban settlement&#39;,
 &#39;Novoye Devyatkino village&#39;,
 &#39;Novy Svet settlement&#39;,
 &#39;Novy Uchkhoz settlement&#39;,
 &#39;Nurma village&#39;,
 &#39;Oredezh settlement&#39;,
 &#39;Orzhitsy village&#39;,
 &#39;Otradnoye&#39;,
 &#39;Pargolovo settlement&#39;,
 &#39;Paritsy village&#39;,
 &#39;Pasha village&#39;,
 &#39;Pavlovo urban settlement&#39;,
 &#39;Pavlovo village&#39;,
 &#39;Pavlovsk&#39;,
 &#39;Pcheva village&#39;,
 &#39;Pchevzha village&#39;,
 &#39;Pelgora village&#39;,
 &#39;Peniki village&#39;,
 &#39;Pension Zeleny Bor settlement&#39;,
 &#39;Perovo settlement&#39;,
 &#39;Pervomayskoye settlement&#39;,
 &#39;Pesochny settlement&#39;,
 &#39;Peterhof&#39;,
 &#39;Petro-Slavianka settlement&#39;,
 &#39;Petrovskoye settlement&#39;,
 &#39;Pikalyovo&#39;,
 &#39;Pikkolovo village&#39;,
 &#39;Pizhma village&#39;,
 &#39;Platform 69th kilometer settlement&#39;,
 &#39;Plodovoye settlement&#39;,
 &#39;Ploskoe settlement&#39;,
 &#39;Pobeda settlement&#39;,
 &#39;Pochap settlement&#39;,
 &#39;Pochinok settlement&#39;,
 &#39;Podporozhye&#39;,
 &#39;Polyany settlement&#39;,
 &#39;Pontonny settlement&#39;,
 &#39;Prigorodny settlement&#39;,
 &#39;Priladozhsky garden community&#39;,
 &#39;Priladozhsky urban-type settlement&#39;,
 &#39;Primorsk&#39;,
 &#39;Priozersk&#39;,
 &#39;Privetninskoye station settlement&#39;,
 &#39;Pudomyagi village&#39;,
 &#39;Pudost settlement&#39;,
 &#39;Pushkin&#39;,
 &#39;Pushnoye village&#39;,
 &#39;Pustynka village&#39;,
 &#39;Putilovo village&#39;,
 &#39;Rabititsy village&#39;,
 &#39;Rakhya garden community&#39;,
 &#39;Rakhya urban settlement&#39;,
 &#39;Rappolovo village&#39;,
 &#39;Razbegaevo village&#39;,
 &#39;Razdolie village&#39;,
 &#39;Razmettelevo village&#39;,
 &#39;Rebrovo village&#39;,
 &#39;Repino settlement&#39;,
 &#39;Romanovka settlement&#39;,
 &#39;Romashki settlement&#39;,
 &#39;Ropsha settlement&#39;,
 &#39;Roshchino urban settlement&#39;,
 &#39;Roshchino urban-type settlement&#39;,
 &#39;Rozhdestrovo village&#39;,
 &#39;Russko village&#39;,
 &#39;Russko-Vysotskoye village&#39;,
 &#39;Ryabovo settlement&#39;,
 &#39;Ryabovo urban-type settlement&#39;,
 &#39;Sadko garden community&#39;,
 &#39;Sapernoye settlement&#39;,
 &#39;Saperny settlement&#39;,
 &#39;Schastye cottage settlement&#39;,
 &#39;Seleznyovo settlement&#39;,
 &#39;Seltso settlement&#39;,
 &#39;Semiozerie settlement&#39;,
 &#39;Semrino settlement&#39;,
 &#39;Serebryansky settlement&#39;,
 &#39;Sertolovo&#39;,
 &#39;Sestroretsk&#39;,
 &#39;Sevastyanovo settlement&#39;,
 &#39;Shcheglovo settlement&#39;,
 &#39;Shcheglovo village&#39;,
 &#39;Shlisselburg&#39;,
 &#39;Shpankovo village&#39;,
 &#39;Shugozero village&#39;,
 &#39;Shum village&#39;,
 &#39;Shushary settlement&#39;,
 &#39;Sinyavino urban-type settlement&#39;,
 &#39;Siversky urban-type settlement&#39;,
 &#39;Sizhno village&#39;,
 &#39;Slantsy&#39;,
 &#39;Snegiryovka village&#39;,
 &#39;Sosnovo village&#39;,
 &#39;Sosnovy Bor&#39;,
 &#39;Sovetskiy urban settlement&#39;,
 &#39;Sovetskiy urban-type settlement&#39;,
 &#39;Sovkhozny village&#39;,
 &#39;St. Petersburg&#39;,
 &#39;Staraya Ladoga village&#39;,
 &#39;Staraya Maluksa settlement&#39;,
 &#39;Staraya Pustosh village&#39;,
 &#39;Staraya village&#39;,
 &#39;Staropolye village&#39;,
 &#39;Starosiverskaya village&#39;,
 &#39;Staroye Khinkolovo village&#39;,
 &#39;Starye Begunitsy village&#39;,
 &#39;Strelna settlement&#39;,
 &#39;Suida settlement&#39;,
 &#39;Sukhodolie settlement&#39;,
 &#39;Sumino settlement&#39;,
 &#39;Suoranda village&#39;,
 &#39;Sverdlov urban-type settlement&#39;,
 &#39;Svetogorsk&#39;,
 &#39;Svir station settlement&#39;,
 &#39;Svirstroy urban settlement&#39;,
 &#39;Syaakelevo village&#39;,
 &#39;Syaastroy&#39;,
 &#39;Taitsy urban-type settlement&#39;,
 &#39;Tarasovo village&#39;,
 &#39;Telmana settlement&#39;,
 &#39;Terpilitsy village&#39;,
 &#39;Tervolovo settlement&#39;,
 &#39;Tikhkovitsy village&#39;,
 &#39;Tikhvin&#39;,
 &#39;Toivorovo village&#39;,
 &#39;Toksovo urban-type settlement&#39;,
 &#39;Torfyanoye settlement&#39;,
 &#39;Torkovichi settlement&#39;,
 &#39;Toroshkovichi village&#39;,
 &#39;Torosovo village&#39;,
 &#39;Tosno&#39;,
 &#39;Trubnikov Bor village&#39;,
 &#39;Tsvelodubovo settlement&#39;,
 &#39;Tsvylyovo settlement&#39;,
 &#39;Tyosovo-4 village&#39;,
 &#39;Uglovo settlement&#39;,
 &#39;Ulyanovka urban-type settlement&#39;,
 &#39;Ushaki settlement&#39;,
 &#39;Ust-Izhora settlement&#39;,
 &#39;Ust-Luga settlement&#39;,
 &#39;Vaganovo village&#39;,
 &#39;Vakhnova Kara village&#39;,
 &#39;Vartemägi village&#39;,
 &#39;Vazhyny urban-type settlement&#39;,
 &#39;Veschevo station settlement&#39;,
 &#39;Villozi urban settlement&#39;,
 &#39;Voiskorovo settlement&#39;,
 &#39;Volkhov&#39;,
 &#39;Volodarskoe settlement&#39;,
 &#39;Volosovo&#39;,
 &#39;Voyskovitsy settlement&#39;,
 &#39;Voznesenye urban-type settlement&#39;,
 &#39;Vozrozhdenie settlement&#39;,
 &#39;Vsevolozhsk&#39;,
 &#39;Vyborg&#39;,
 &#39;Vyritsa urban-type settlement&#39;,
 &#39;Vyskatka village&#39;,
 &#39;Vysokoklyuchevoy settlement&#39;,
 &#39;Vysotsk&#39;,
 &#39;Yalgelevo village&#39;,
 &#39;Yalgino village&#39;,
 &#39;Yam-Tesovo village&#39;,
 &#39;Yanino-1 urban settlement&#39;,
 &#39;Yukki village&#39;,
 &#39;Zaklinye village&#39;,
 &#39;Zanevka village&#39;,
 &#39;Zaporozhskoye settlement&#39;,
 &#39;Zavodskoy settlement&#39;,
 &#39;Zelenogorsk&#39;,
 &#39;Zhilgorodok settlement&#39;,
 &#39;Zhilposelok settlement&#39;,
 &#39;Zhitkovo settlement&#39;,
 &#39;Zimititsy settlement&#39;,
 &#39;Zimititsy village&#39;,
 &#39;settlement at Privetninskoye railway station&#39;,
 &#39;settlement at Veschevo railway station&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">loc_1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">settlements</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">loc_2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">loc_1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">settlements</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">settlements</span><span class="p">[</span><span class="n">loc_1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">settlements</span><span class="p">[</span><span class="n">loc_2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">settlements</span><span class="p">[</span><span class="n">loc_1</span><span class="p">],</span> <span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="n">settlements</span><span class="p">[</span><span class="n">loc_2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bolshaya Izhora urban settlement | Bolshaya Izhora urban-type settlement
Bolshaya Izhora urban settlement | Bolshaya Pustomierzha village
Bolshaya Izhora urban settlement | Bolshaya Vruda village
Bolshaya Izhora urban-type settlement | Bolshaya Pustomierzha village
Bolshaya Izhora urban-type settlement | Bolshaya Vruda village
Bolshaya Pustomierzha village | Bolshaya Vruda village
Fedorovskoye urban settlement | Fedorovskoye village
Garbolovo settlement | Garbolovo village
Gromovo settlement | Gromovo station settlement
Kalitino settlement | Kalitino village
Kudrovo | Kudrovo village
Lesnoye cottage settlement | Lesnoye village
Lesogorsky urban settlement | Lesogorsky urban-type settlement
Luban | Luban settlement
Mga urban settlement | Mga urban-type settlement
Murino | Murino settlement
Nazia urban settlement | Nazia urban-type settlement
Nikolskoye | Nikolskoye village
Novaya Ladoga | Novaya Ropsha garden community
Novy Svet settlement | Novy Uchkhoz settlement
Pavlovo urban settlement | Pavlovo village
Priladozhsky garden community | Priladozhsky urban-type settlement
Rakhya garden community | Rakhya urban settlement
Roshchino urban settlement | Roshchino urban-type settlement
Ryabovo settlement | Ryabovo urban-type settlement
Shcheglovo settlement | Shcheglovo village
Sovetskiy urban settlement | Sovetskiy urban-type settlement
Staraya Ladoga village | Staraya Maluksa settlement
Staraya Ladoga village | Staraya Pustosh village
Staraya Ladoga village | Staraya village
Staraya Maluksa settlement | Staraya Pustosh village
Staraya Maluksa settlement | Staraya village
Staraya Pustosh village | Staraya village
Zimititsy settlement | Zimititsy village
settlement at Privetninskoye railway station | settlement at Veschevo railway station
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;locality_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;locality_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;village&#39;</span><span class="p">,</span> <span class="s1">&#39;settlement&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;locality_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;locality_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;urban settlement&#39;</span><span class="p">,</span> <span class="s1">&#39;settlement&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;locality_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;locality_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;urban-type settlement&#39;</span><span class="p">,</span> <span class="s1">&#39;settlement&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;locality_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;locality_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;garden community&#39;</span><span class="p">,</span> <span class="s1">&#39;settlement&#39;</span><span class="p">)</span>
<span class="c1"># data[&#39;locality_name&#39;] = data[&#39;locality_name&#39;].str.replace(&#39;|&#39;.join([&#39;village&#39;, &#39;urban settlement&#39;, &#39;urban-type settlement&#39;]), &#39;settlement&#39;)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;locality_name&#39;</span><span class="p">:{</span>
    <span class="s1">&#39;settlement at Privetninskoye railway station&#39;</span><span class="p">:</span> <span class="s1">&#39;Privetninskoye station settlement&#39;</span><span class="p">,</span>
    <span class="s1">&#39;settlement at Veschevo railway station&#39;</span><span class="p">:</span> <span class="s1">&#39;Veschevo station settlement&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Gromovo settlement&#39;</span><span class="p">:</span> <span class="s1">&#39;Gromovo station settlement&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Lesnoye village&#39;</span><span class="p">:</span> <span class="s1">&#39;Lesnoye cottage settlement&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Nikolskoye&#39;</span><span class="p">:</span> <span class="s1">&#39;Nikolskoye settlement&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Kudrovo&#39;</span><span class="p">:</span> <span class="s1">&#39;Kudrovo settlement&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Luban&#39;</span><span class="p">:</span> <span class="s1">&#39;Luban settlement&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Murino&#39;</span><span class="p">:</span> <span class="s1">&#39;Murino settlement&#39;</span>
<span class="p">}}))</span>
</pre></div>
</div>
</div>
</div>
<p>I don’t think there’s anything left.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
</section>
<section id="troubleshooting-abnormal-values">
<h3>Troubleshooting abnormal values<a class="headerlink" href="#troubleshooting-abnormal-values" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_images</th>
      <th>last_price</th>
      <th>total_area</th>
      <th>rooms</th>
      <th>ceiling_height</th>
      <th>floors_total</th>
      <th>living_area</th>
      <th>floor</th>
      <th>kitchen_area</th>
      <th>balcony</th>
      <th>airports_nearest</th>
      <th>cityCenters_nearest</th>
      <th>parks_around3000</th>
      <th>parks_nearest</th>
      <th>ponds_around3000</th>
      <th>ponds_nearest</th>
      <th>days_exposition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>23565.000000</td>
      <td>2.356500e+04</td>
      <td>23565.000000</td>
      <td>23565.000000</td>
      <td>23565.000000</td>
      <td>23565.000000</td>
      <td>21700.000000</td>
      <td>23565.000000</td>
      <td>23565.000000</td>
      <td>23565.000000</td>
      <td>23565.000000</td>
      <td>18133.000000</td>
      <td>23565.000000</td>
      <td>17579.000000</td>
      <td>23565.000000</td>
      <td>18048.000000</td>
      <td>20394.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>9.878421</td>
      <td>6.540058e+06</td>
      <td>60.322824</td>
      <td>2.070656</td>
      <td>2.784944</td>
      <td>10.675875</td>
      <td>34.454822</td>
      <td>5.878124</td>
      <td>10.423234</td>
      <td>0.593677</td>
      <td>28318.855803</td>
      <td>14195.267882</td>
      <td>0.468831</td>
      <td>475.895244</td>
      <td>0.589900</td>
      <td>510.622257</td>
      <td>180.741395</td>
    </tr>
    <tr>
      <th>std</th>
      <td>5.681156</td>
      <td>1.091093e+07</td>
      <td>35.657060</td>
      <td>1.078591</td>
      <td>0.989254</td>
      <td>6.594823</td>
      <td>22.045359</td>
      <td>4.871485</td>
      <td>5.631746</td>
      <td>0.960660</td>
      <td>11086.811381</td>
      <td>8610.213514</td>
      <td>0.748403</td>
      <td>234.981831</td>
      <td>0.883966</td>
      <td>199.869658</td>
      <td>219.732782</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>1.219000e+04</td>
      <td>12.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>1.300000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>181.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>13.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>6.000000</td>
      <td>3.400000e+06</td>
      <td>40.000000</td>
      <td>1.000000</td>
      <td>2.600000</td>
      <td>5.000000</td>
      <td>18.600000</td>
      <td>2.000000</td>
      <td>7.300000</td>
      <td>0.000000</td>
      <td>21166.000000</td>
      <td>9265.000000</td>
      <td>0.000000</td>
      <td>433.000000</td>
      <td>0.000000</td>
      <td>466.000000</td>
      <td>45.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>9.000000</td>
      <td>4.646000e+06</td>
      <td>52.000000</td>
      <td>2.000000</td>
      <td>2.800000</td>
      <td>9.000000</td>
      <td>30.000000</td>
      <td>4.000000</td>
      <td>9.100000</td>
      <td>0.000000</td>
      <td>26757.000000</td>
      <td>13073.000000</td>
      <td>0.000000</td>
      <td>460.000000</td>
      <td>0.000000</td>
      <td>504.000000</td>
      <td>95.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>14.000000</td>
      <td>6.790000e+06</td>
      <td>69.700000</td>
      <td>3.000000</td>
      <td>2.800000</td>
      <td>16.000000</td>
      <td>42.300000</td>
      <td>8.000000</td>
      <td>11.410000</td>
      <td>1.000000</td>
      <td>34324.000000</td>
      <td>16275.000000</td>
      <td>1.000000</td>
      <td>460.000000</td>
      <td>1.000000</td>
      <td>563.000000</td>
      <td>231.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>50.000000</td>
      <td>7.630000e+08</td>
      <td>900.000000</td>
      <td>19.000000</td>
      <td>100.000000</td>
      <td>60.000000</td>
      <td>409.700000</td>
      <td>33.000000</td>
      <td>112.000000</td>
      <td>5.000000</td>
      <td>84869.000000</td>
      <td>65968.000000</td>
      <td>3.000000</td>
      <td>3190.000000</td>
      <td>3.000000</td>
      <td>1344.000000</td>
      <td>1580.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_images&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>35    2
37    1
39    1
42    1
50    3
Name: total_images, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>50 photos - why not?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19904     12.0
17961     13.0
19546     13.0
19807     13.0
19558     13.2
         ...  
5358     590.0
15651    618.0
3117     631.0
12859    631.2
19540    900.0
Name: total_area, Length: 23565, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>900 meters exactly is hardly possible. Perhaps 90 was meant, but it is not superfluous to delete.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;total_area&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/42d246c5171c203062310a709780641df4a5b2c9566b270e6cfc7704fd167b0b.png" src="_images/42d246c5171c203062310a709780641df4a5b2c9566b270e6cfc7704fd167b0b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;total_area &lt; 550&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;total_area&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/7da307b003399883ad169a76dc2d7046bd471da30fb38ce5870f9c860e6b3278.png" src="_images/7da307b003399883ad169a76dc2d7046bd471da30fb38ce5870f9c860e6b3278.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;total_area &lt; total_area.quantile(0.75)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;total_area&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/1d2be90ad9372138d95030ea1e5da7aa4c92adbce871a6ca2dae6b60f13ae9d8.png" src="_images/1d2be90ad9372138d95030ea1e5da7aa4c92adbce871a6ca2dae6b60f13ae9d8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12.00    1
13.00    3
13.20    1
14.00    1
15.00    2
15.50    1
16.00    1
17.00    2
17.20    1
17.60    1
17.78    1
18.00    5
18.40    1
18.50    1
18.80    1
18.90    1
19.00    2
19.50    1
20.00    8
20.10    1
Name: total_area, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;last_price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8793         12190
17456       430000
14911       430000
16274       440000
16219       450000
           ...    
16461    245000000
22831    289238400
1436     330000000
14706    401300000
12971    763000000
Name: last_price, Length: 23560, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;last_price&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/420f9bfcbdae147156759e3ad1108ba3d287bc8618b8c96fae58caff90bf577f.png" src="_images/420f9bfcbdae147156759e3ad1108ba3d287bc8618b8c96fae58caff90bf577f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">data</span>
 <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;last_price &lt;= last_price.quantile(0.95)&#39;</span><span class="p">)</span>
 <span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;last_price&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/c51e21cd244a012feb26f95277053306a5f1bd4126aa83ffa5055977ba482ba5.png" src="_images/c51e21cd244a012feb26f95277053306a5f1bd4126aa83ffa5055977ba482ba5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;last_price.quantile(0.01) &lt; last_price &lt; last_price.quantile(0.95)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;rooms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([3, 1, 2, 4, 6, 5, 0, 7])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;rooms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/8f337c83451093a0b2fd18eeb38903bf9bb700bee0577b0980c130baa2614ec5.png" src="_images/8f337c83451093a0b2fd18eeb38903bf9bb700bee0577b0980c130baa2614ec5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ceiling_height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>22590      1.0
5712       1.2
16934      1.8
2572       2.0
552        2.0
         ...  
4876      27.0
21377     27.5
22336     32.0
3148      32.0
22869    100.0
Name: ceiling_height, Length: 22134, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>1 meter high - not sure if it’s an apartment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ceiling_height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.3      1
4.4      2
4.5      4
4.7      1
4.8      1
5.3      1
5.8      1
8.0      3
8.3      1
10.3     1
14.0     1
20.0     1
22.6     1
24.0     1
25.0     7
26.0     1
27.0     8
27.5     1
32.0     2
100.0    1
Name: ceiling_height, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Here it is recommended to divide by 10.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ceiling_height&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ceiling_height&#39;</span><span class="p">]</span>
                          <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ceiling_height&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ceiling_height&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;2 &lt;= ceiling_height &lt;= 8&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;ceiling_height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2.7 , 2.8 , 3.  , 2.5 , 2.6 , 2.9 , 3.2 , 3.4 , 4.2 , 4.  , 3.1 ,
       2.3 , 3.7 , 3.3 , 3.5 , 2.  , 2.4 , 3.8 , 3.6 , 4.1 , 4.8 , 4.5 ,
       8.  , 4.4 , 3.9 , 4.3 , 5.3 , 2.2 , 4.7 , 2.26, 5.8 , 2.75])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;ceiling_height&#39;</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/bf6c168803781d0220b7a10dc9be90efb42827f06d0ed7ccc38ef0a632affa7f.png" src="_images/bf6c168803781d0220b7a10dc9be90efb42827f06d0ed7ccc38ef0a632affa7f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;floors_total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17020     1
15543     1
8335      1
11641     1
18900     1
         ..
11079    36
5807     36
397      36
16731    52
2253     60
Name: floors_total, Length: 22127, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;floors_total&#39;</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/418a0ee20dbb166ea6ec38bb9a726b7b26cff660c6c5658b73ac3a649541299f.png" src="_images/418a0ee20dbb166ea6ec38bb9a726b7b26cff660c6c5658b73ac3a649541299f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_images</th>
      <th>last_price</th>
      <th>total_area</th>
      <th>rooms</th>
      <th>ceiling_height</th>
      <th>floors_total</th>
      <th>living_area</th>
      <th>floor</th>
      <th>kitchen_area</th>
      <th>balcony</th>
      <th>airports_nearest</th>
      <th>cityCenters_nearest</th>
      <th>parks_around3000</th>
      <th>parks_nearest</th>
      <th>ponds_around3000</th>
      <th>ponds_nearest</th>
      <th>days_exposition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>22127.000000</td>
      <td>2.212700e+04</td>
      <td>22127.000000</td>
      <td>22127.000000</td>
      <td>22127.000000</td>
      <td>22127.000000</td>
      <td>20446.000000</td>
      <td>22127.000000</td>
      <td>22127.000000</td>
      <td>22127.000000</td>
      <td>22127.000000</td>
      <td>16943.000000</td>
      <td>22127.000000</td>
      <td>16390.000000</td>
      <td>22127.000000</td>
      <td>16859.000000</td>
      <td>19360.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>9.773489</td>
      <td>5.210268e+06</td>
      <td>55.364690</td>
      <td>1.981697</td>
      <td>2.743002</td>
      <td>10.829258</td>
      <td>31.764574</td>
      <td>5.913906</td>
      <td>9.841527</td>
      <td>0.598228</td>
      <td>28366.298097</td>
      <td>14672.320811</td>
      <td>0.437881</td>
      <td>475.844814</td>
      <td>0.555340</td>
      <td>515.531141</td>
      <td>176.491426</td>
    </tr>
    <tr>
      <th>std</th>
      <td>5.593868</td>
      <td>2.695476e+06</td>
      <td>22.000168</td>
      <td>0.951304</td>
      <td>0.207873</td>
      <td>6.634220</td>
      <td>15.183506</td>
      <td>4.905438</td>
      <td>4.095087</td>
      <td>0.954166</td>
      <td>11272.534025</td>
      <td>8569.538235</td>
      <td>0.718626</td>
      <td>226.741631</td>
      <td>0.851645</td>
      <td>197.335548</td>
      <td>215.809028</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>1.010000e+06</td>
      <td>12.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>1.300000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>208.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>13.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>6.000000</td>
      <td>3.400000e+06</td>
      <td>39.700000</td>
      <td>1.000000</td>
      <td>2.600000</td>
      <td>5.000000</td>
      <td>18.300000</td>
      <td>2.000000</td>
      <td>7.200000</td>
      <td>0.000000</td>
      <td>20758.000000</td>
      <td>10185.500000</td>
      <td>0.000000</td>
      <td>435.000000</td>
      <td>0.000000</td>
      <td>478.000000</td>
      <td>44.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>9.000000</td>
      <td>4.500000e+06</td>
      <td>50.500000</td>
      <td>2.000000</td>
      <td>2.800000</td>
      <td>9.000000</td>
      <td>29.900000</td>
      <td>4.000000</td>
      <td>9.100000</td>
      <td>0.000000</td>
      <td>26757.000000</td>
      <td>13365.000000</td>
      <td>0.000000</td>
      <td>460.000000</td>
      <td>0.000000</td>
      <td>504.000000</td>
      <td>93.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>14.000000</td>
      <td>6.300000e+06</td>
      <td>66.000000</td>
      <td>3.000000</td>
      <td>2.800000</td>
      <td>16.000000</td>
      <td>40.700000</td>
      <td>8.000000</td>
      <td>11.000000</td>
      <td>1.000000</td>
      <td>34716.500000</td>
      <td>16527.000000</td>
      <td>1.000000</td>
      <td>460.000000</td>
      <td>1.000000</td>
      <td>566.500000</td>
      <td>224.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>50.000000</td>
      <td>1.519050e+07</td>
      <td>320.000000</td>
      <td>7.000000</td>
      <td>8.000000</td>
      <td>60.000000</td>
      <td>190.000000</td>
      <td>33.000000</td>
      <td>100.700000</td>
      <td>5.000000</td>
      <td>84869.000000</td>
      <td>65968.000000</td>
      <td>3.000000</td>
      <td>3190.000000</td>
      <td>3.000000</td>
      <td>1344.000000</td>
      <td>1580.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The numbers seem realistic.</p>
<p>Summary:</p>
<p>There were no exact duplicates in the data, but there were quite a few missing values. These were mostly skips in insignificant factors, such as the number of balconies, whether the property belonged to the apartment class, distance to parks and ponds. Such gaps were replaced by zeros, average numbers or strings characterizing the unknown parameter.</p>
<p>Speaking of missing values in more important columns, there were some that could be safely deleted without losing a significant layer of information (such as a couple of hundred lines with an unknown name of a settlement or number of floors).</p>
<p>Nevertheless, for some necessary parameters (such as living space, offer validity time or distance to the city center), we had to leave the NaNs, because they constituted a significant part of the data (distributed in the same way as the main array).</p>
<p>Some of them were replaced by the median for the settlement, but it did not work for all cases, because in small towns and villages no one indicates the distance to the center, parks and ponds.</p>
<p>As for the numbers themselves, there were not many abnormal values. The single anomalies were not difficult to remove or convert into realistic numbers (in the case of ceiling heights), but for most of the data it was difficult to find the boundary up to which it makes sense to consider the ad while after it — not. As a result, apartments with more than 7 rooms were left out of this analysis.</p>
</section>
</section>
<section id="data-categorization">
<h2>Data categorization<a class="headerlink" href="#data-categorization" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_images</th>
      <th>last_price</th>
      <th>total_area</th>
      <th>first_day_exposition</th>
      <th>rooms</th>
      <th>ceiling_height</th>
      <th>floors_total</th>
      <th>living_area</th>
      <th>floor</th>
      <th>is_apartment</th>
      <th>...</th>
      <th>kitchen_area</th>
      <th>balcony</th>
      <th>locality_name</th>
      <th>airports_nearest</th>
      <th>cityCenters_nearest</th>
      <th>parks_around3000</th>
      <th>parks_nearest</th>
      <th>ponds_around3000</th>
      <th>ponds_nearest</th>
      <th>days_exposition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>23694</th>
      <td>9</td>
      <td>9700000</td>
      <td>133.81</td>
      <td>2017-03-21T00:00:00</td>
      <td>3</td>
      <td>3.7</td>
      <td>5</td>
      <td>73.3</td>
      <td>3</td>
      <td>unknown</td>
      <td>...</td>
      <td>13.83</td>
      <td>0</td>
      <td>St. Petersburg</td>
      <td>24665.0</td>
      <td>4232.0</td>
      <td>1</td>
      <td>796.0</td>
      <td>3</td>
      <td>381.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>23695</th>
      <td>14</td>
      <td>3100000</td>
      <td>59.00</td>
      <td>2018-01-15T00:00:00</td>
      <td>3</td>
      <td>2.8</td>
      <td>5</td>
      <td>38.0</td>
      <td>4</td>
      <td>unknown</td>
      <td>...</td>
      <td>8.50</td>
      <td>0</td>
      <td>Tosno</td>
      <td>26757.0</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>45.0</td>
    </tr>
    <tr>
      <th>23696</th>
      <td>18</td>
      <td>2500000</td>
      <td>56.70</td>
      <td>2018-02-11T00:00:00</td>
      <td>2</td>
      <td>2.8</td>
      <td>3</td>
      <td>29.7</td>
      <td>1</td>
      <td>unknown</td>
      <td>...</td>
      <td>9.10</td>
      <td>0</td>
      <td>Rozhdestrovo settlement</td>
      <td>26757.0</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>23697</th>
      <td>13</td>
      <td>11475000</td>
      <td>76.75</td>
      <td>2017-03-28T00:00:00</td>
      <td>2</td>
      <td>3.0</td>
      <td>17</td>
      <td>NaN</td>
      <td>12</td>
      <td>unknown</td>
      <td>...</td>
      <td>23.30</td>
      <td>2</td>
      <td>St. Petersburg</td>
      <td>39140.0</td>
      <td>10364.0</td>
      <td>2</td>
      <td>173.0</td>
      <td>3</td>
      <td>196.0</td>
      <td>602.0</td>
    </tr>
    <tr>
      <th>23698</th>
      <td>4</td>
      <td>1350000</td>
      <td>32.30</td>
      <td>2017-07-21T00:00:00</td>
      <td>1</td>
      <td>2.5</td>
      <td>5</td>
      <td>12.3</td>
      <td>1</td>
      <td>unknown</td>
      <td>...</td>
      <td>9.00</td>
      <td>0</td>
      <td>Novy Uchkhoz settlement</td>
      <td>26757.0</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div></div>
</div>
<p>Data should be categorized and grouped for better analysis and visualization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s add the cost per square meter of the apartment</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;one_meter_cost&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;last_price&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_area&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;first_day_exposition&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;first_day_exposition&#39;</span><span class="p">],</span> 
                                                <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%S&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adding categories by date</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">data</span><span class="p">[</span><span class="s1">&#39;first_day_exposition&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">weekday</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">data</span><span class="p">[</span><span class="s1">&#39;first_day_exposition&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">data</span><span class="p">[</span><span class="s1">&#39;first_day_exposition&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;month_datetime64&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;first_day_exposition&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;datetime64[M]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;first_day_exposition&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;month_datetime64&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first_day_exposition</th>
      <th>month</th>
      <th>month_datetime64</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-03-07</td>
      <td>3</td>
      <td>2019-03-01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2018-12-04</td>
      <td>12</td>
      <td>2018-12-01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2015-08-20</td>
      <td>8</td>
      <td>2015-08-01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2018-06-19</td>
      <td>6</td>
      <td>2018-06-01</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2018-09-10</td>
      <td>9</td>
      <td>2018-09-01</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>23694</th>
      <td>2017-03-21</td>
      <td>3</td>
      <td>2017-03-01</td>
    </tr>
    <tr>
      <th>23695</th>
      <td>2018-01-15</td>
      <td>1</td>
      <td>2018-01-01</td>
    </tr>
    <tr>
      <th>23696</th>
      <td>2018-02-11</td>
      <td>2</td>
      <td>2018-02-01</td>
    </tr>
    <tr>
      <th>23697</th>
      <td>2017-03-28</td>
      <td>3</td>
      <td>2017-03-01</td>
    </tr>
    <tr>
      <th>23698</th>
      <td>2017-07-21</td>
      <td>7</td>
      <td>2017-07-01</td>
    </tr>
  </tbody>
</table>
<p>22127 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">data</span>
 <span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;month_datetime64&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;last_price&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">)</span>
 <span class="o">.</span><span class="n">plot</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;month_datetime64&#39;&gt;
</pre></div>
</div>
<img alt="_images/504c117ca594a49125de90204d7feb2c6851c8c385685e3cbec9eae65fcf442e.png" src="_images/504c117ca594a49125de90204d7feb2c6851c8c385685e3cbec9eae65fcf442e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_floor_type</span><span class="p">(</span><span class="n">floor</span><span class="p">,</span> <span class="n">total_floors</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">floor</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;first&#39;</span>
    <span class="k">elif</span> <span class="n">floor</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">floor</span> <span class="o">==</span> <span class="n">total_floors</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;last&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;other&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;floor_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> 
                             <span class="n">get_floor_type</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;floor&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;floors_total&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;cityCenters_nearest&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;cityCenters_nearest&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;cityCenters_nearest&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0        16.0
1        19.0
2        14.0
4         8.0
5         NaN
         ... 
23694     4.0
23695     NaN
23696     NaN
23697    10.0
23698     NaN
Name: cityCenters_nearest, Length: 22127, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="exploratory-data-analysis">
<h2>Exploratory data analysis<a class="headerlink" href="#exploratory-data-analysis" title="Link to this heading">#</a></h2>
<p>Let’s plot the distributions of factors that can be associated with sales.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;total_images&#39;, &#39;last_price&#39;, &#39;total_area&#39;, &#39;first_day_exposition&#39;, &#39;rooms&#39;, &#39;ceiling_height&#39;, &#39;floors_total&#39;, &#39;living_area&#39;, &#39;floor&#39;, &#39;is_apartment&#39;, &#39;studio&#39;, &#39;open_plan&#39;, &#39;kitchen_area&#39;, &#39;balcony&#39;, &#39;locality_name&#39;, &#39;airports_nearest&#39;, &#39;cityCenters_nearest&#39;, &#39;parks_around3000&#39;, &#39;parks_nearest&#39;, &#39;ponds_around3000&#39;, &#39;ponds_nearest&#39;, &#39;days_exposition&#39;, &#39;one_meter_cost&#39;, &#39;day&#39;, &#39;month&#39;, &#39;year&#39;, &#39;month_datetime64&#39;, &#39;floor_type&#39;]
</pre></div>
</div>
</div>
</div>
<section id="meters">
<h3>Meters<a class="headerlink" href="#meters" title="Link to this heading">#</a></h3>
<p>Firstly, to the estimation of the total floor area, living area and kitchen area of the available properties.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_area&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5ebe5c1965d27b88d28775c7c987173c7f536eb2204eb755855fda9d981bf862.png" src="_images/5ebe5c1965d27b88d28775c7c987173c7f536eb2204eb755855fda9d981bf862.png" />
</div>
</div>
<p>The total area of apartments is gradually decreasing with a peak around 50 square meters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;living_area&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/57ef1a97784733936ee0543be73caf3a97c02b04b44b3df3cefe5759f50543bd.png" src="_images/57ef1a97784733936ee0543be73caf3a97c02b04b44b3df3cefe5759f50543bd.png" />
</div>
</div>
<p>Speaking of living area, we can see two peaks of 18 and 30 square meters, as well as a solid array of data in the region of about 40. Apparently, this reflects apartments with 1, 2 or more rooms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;kitchen_area&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fa375290fa35821e4221c7a448bf7b67f2b7ff9782ec9ef082dfb4a785c1155a.png" src="_images/fa375290fa35821e4221c7a448bf7b67f2b7ff9782ec9ef082dfb4a785c1155a.png" />
</div>
</div>
<p>The most common kitchens are 10 square meters.</p>
</section>
<section id="price-of-the-object">
<h3>Price of the object<a class="headerlink" href="#price-of-the-object" title="Link to this heading">#</a></h3>
<p>Let’s look at the distribution of price. Although without categorization, the numbers will be quite abstract.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;last_price&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20000000</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1aa93cb54db56af666fb89199b89b3a969bee5d928699e79fdf9a0f4840fc5db.png" src="_images/1aa93cb54db56af666fb89199b89b3a969bee5d928699e79fdf9a0f4840fc5db.png" />
</div>
</div>
<p>I don’t know if it’s a skewed normal distribution or another one, but the pattern around 4 million is present.</p>
</section>
<section id="number-of-rooms">
<h3>Number of rooms<a class="headerlink" href="#number-of-rooms" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;rooms&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2760a490ed0cb75bf1314cbfb1fa5297cc8ce9cb14cd286271ebe0988afcff12.png" src="_images/2760a490ed0cb75bf1314cbfb1fa5297cc8ce9cb14cd286271ebe0988afcff12.png" />
</div>
</div>
<p>I wonder what an apartment with zero rooms looks like.</p>
</section>
<section id="ceiling-height">
<h3>Ceiling height<a class="headerlink" href="#ceiling-height" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ceiling_height&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f0024ef840546d593ab998cc2992046a2a0ed1686e589ad6de3e960cd33c47b2.png" src="_images/f0024ef840546d593ab998cc2992046a2a0ed1686e589ad6de3e960cd33c47b2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ceiling_height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.8
</pre></div>
</div>
</div>
</div>
<p>I guess that’s the standard.</p>
</section>
<section id="apartment-floor">
<h3>Apartment Floor<a class="headerlink" href="#apartment-floor" title="Link to this heading">#</a></h3>
<p>We shall now consider the distribution of properties by the apartment floor and the overall height of the building in which it is located.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;floor&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1b9c224affba0264f3c1f90c92ea03c2a8fac498a33565f4b1043c25e536deec.png" src="_images/1b9c224affba0264f3c1f90c92ea03c2a8fac498a33565f4b1043c25e536deec.png" />
</div>
</div>
<p>The predominant building in the region is five stories.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;floor_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/155c965b8dfbd5e1028a1af48b1fee3682f88d7edae26fc476d7f7497e71b6b4.png" src="_images/155c965b8dfbd5e1028a1af48b1fee3682f88d7edae26fc476d7f7497e71b6b4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;floor_type == &quot;last&quot;&#39;</span><span class="p">)[</span><span class="s1">&#39;floor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5     1198
9      387
4      293
3      209
2      162
6      119
12     110
10     106
16      89
7       65
Name: floor, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>This also confirms the predominance of five-storey buildings. Now to the distribution of the total number of floors in the region.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;floors_total&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f12ee313a5f8a26f829ab77cd2f89c5b855b1dcf882fe043748d330a3f33dc42.png" src="_images/f12ee313a5f8a26f829ab77cd2f89c5b855b1dcf882fe043748d330a3f33dc42.png" />
</div>
</div>
<p>Interestingly, 9 stories is also common.</p>
</section>
<section id="distances-to-objects">
<h3>Distances to objects<a class="headerlink" href="#distances-to-objects" title="Link to this heading">#</a></h3>
<p>Let’s explore distances to airports, parks, and city center (in ascending order of priority).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;airports_nearest&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5ea7b3f8ca0bb8b3c1483ea52931cbaea3cb77a4a8b8294279ed9e9a18e22030.png" src="_images/5ea7b3f8ca0bb8b3c1483ea52931cbaea3cb77a4a8b8294279ed9e9a18e22030.png" />
</div>
</div>
<p>The peak is the median, which we replaced a huge number of gaps with. So no discovery.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;parks_nearest&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4466d64149bed7ecf218ddb92dc82cb683541631592b76eb09300b016f83ac61.png" src="_images/4466d64149bed7ecf218ddb92dc82cb683541631592b76eb09300b016f83ac61.png" />
</div>
</div>
<p>Same thing. Let’s confirm it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="s1">&#39;parks_nearest&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fced97ed7ef8afee168542d32efdb89fe32f268b25e503b99997552aa846104f.png" src="_images/fced97ed7ef8afee168542d32efdb89fe32f268b25e503b99997552aa846104f.png" />
</div>
</div>
<p>The farther away the park is, the less often this is pointed out and more omitted.</p>
<p>Finally, the most interesting part.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is the raw data</span>
<span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="s1">&#39;cityCenters_nearest&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40000</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fafc45bcf642d85df6cb176e5d057e55de30ec8f1146e0c019548b2babf8ab46.png" src="_images/fafc45bcf642d85df6cb176e5d057e55de30ec8f1146e0c019548b2babf8ab46.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # This is pre-processed</span>
<span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;cityCenters_nearest&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/887980e92976e9c9e7813617731ae1feed8e57ec8c9cedc05e6e55aa739c9e88.png" src="_images/887980e92976e9c9e7813617731ae1feed8e57ec8c9cedc05e6e55aa739c9e88.png" />
</div>
</div>
<p>The profile is similar, although a couple of columns has risen. Probably due to filling in the gaps with medians in large cities.</p>
<p>Let’s see if it looks like SPb.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span>
      <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;locality_name == &quot;St. Petersburg&quot;&#39;</span><span class="p">)</span>
      <span class="p">[</span><span class="s1">&#39;cityCenters_nearest&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3ce8ed7d5a22f7be9b9949d6637a9d28600489b2a8d834ebd8118e39078f4fd3.png" src="_images/3ce8ed7d5a22f7be9b9949d6637a9d28600489b2a8d834ebd8118e39078f4fd3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;locality_name == &quot;St. Petersburg&quot;&#39;</span><span class="p">)[</span><span class="s1">&#39;cityCenters_nearest&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12.0    1608
15.0    1522
13.0    1425
14.0    1263
16.0    1251
Name: cityCenters_nearest, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;locality_name == &quot;St. Petersburg&quot;&#39;</span><span class="p">)[</span><span class="s1">&#39;cityCenters_nearest&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11.978337357709554
</pre></div>
</div>
</div>
</div>
<p>That’s an average for St. Petersburg.</p>
</section>
<section id="advertisement-publication-date">
<h3>Advertisement Publication Date<a class="headerlink" href="#advertisement-publication-date" title="Link to this heading">#</a></h3>
<p>Let’s consider the distribution by the day the ad was published.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/aced947e43137a8fea829a1cd6c8c0248a4febe3311c57c73c41b1ad1d9abe28.png" src="_images/aced947e43137a8fea829a1cd6c8c0248a4febe3311c57c73c41b1ad1d9abe28.png" />
</div>
</div>
<p>It’s strange that Saturday and Sunday are dipping. May be the real estate agents’ weekend.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dab8aee61dfbad208e4c690ffb119c94658e50a1fa0a1af56ee302fb01e04865.png" src="_images/dab8aee61dfbad208e4c690ffb119c94658e50a1fa0a1af56ee302fb01e04865.png" />
</div>
</div>
<p>Early spring and fall especially stand out in the overall profile.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">data</span>
 <span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;last_price&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
 <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2700</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;month&#39;&gt;
</pre></div>
</div>
<img alt="_images/054b13e9b1abc48e6030a714dec28b6c808fce4dbbcba693c929d0634420ca95.png" src="_images/054b13e9b1abc48e6030a714dec28b6c808fce4dbbcba693c929d0634420ca95.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">data</span>
 <span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;month_datetime64&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;last_price&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
 <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1500</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;month_datetime64&#39;&gt;
</pre></div>
</div>
<img alt="_images/4eb53b707ac972dfabfd6be37d0627c7ed67ad13b1b913dd2dee42c5cddfe814.png" src="_images/4eb53b707ac972dfabfd6be37d0627c7ed67ad13b1b913dd2dee42c5cddfe814.png" />
</div>
</div>
</section>
<section id="days-of-exposition">
<h3>Days of exposition<a class="headerlink" href="#days-of-exposition" title="Link to this heading">#</a></h3>
<p>Let’s look at the distribution of ad validity time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;days_exposition&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b7596da97605d033141cd84fda533a26c6d5535188dc403da6da6828d9986c04.png" src="_images/b7596da97605d033141cd84fda533a26c6d5535188dc403da6da6828d9986c04.png" />
</div>
</div>
<p>Looks like kind of a Poisson distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;days_exposition&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/96292b984acf7c450b6f752b3df976fb0ca3c571dffaa65c33ae78fa296bb41b.png" src="_images/96292b984acf7c450b6f752b3df976fb0ca3c571dffaa65c33ae78fa296bb41b.png" />
</div>
</div>
<p>Now that’s something unusual.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">data</span>
 <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;days_exposition &lt;= 100&#39;</span><span class="p">)</span>
 <span class="p">[</span><span class="s1">&#39;days_exposition&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
 <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>45.0    840
60.0    538
7.0     229
30.0    200
4.0     171
       ... 
94.0     47
78.0     46
87.0     40
2.0       3
1.0       1
Name: days_exposition, Length: 100, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">data_with_days</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;days_exposition&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
<span class="n">data_with_days</span><span class="p">[</span><span class="s1">&#39;days_exposition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_with_days</span><span class="p">[</span><span class="s1">&#39;days_exposition&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">data_with_days</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_images</th>
      <th>last_price</th>
      <th>total_area</th>
      <th>first_day_exposition</th>
      <th>rooms</th>
      <th>ceiling_height</th>
      <th>floors_total</th>
      <th>living_area</th>
      <th>floor</th>
      <th>is_apartment</th>
      <th>...</th>
      <th>parks_nearest</th>
      <th>ponds_around3000</th>
      <th>ponds_nearest</th>
      <th>days_exposition</th>
      <th>one_meter_cost</th>
      <th>day</th>
      <th>month</th>
      <th>year</th>
      <th>month_datetime64</th>
      <th>floor_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>23691</th>
      <td>11</td>
      <td>9470000</td>
      <td>72.90</td>
      <td>2016-10-13</td>
      <td>2</td>
      <td>2.8</td>
      <td>25</td>
      <td>40.3</td>
      <td>7</td>
      <td>unknown</td>
      <td>...</td>
      <td>460.0</td>
      <td>1</td>
      <td>806.0</td>
      <td>519</td>
      <td>129903.978052</td>
      <td>3</td>
      <td>10</td>
      <td>2016</td>
      <td>2016-10-01</td>
      <td>other</td>
    </tr>
    <tr>
      <th>23692</th>
      <td>2</td>
      <td>1350000</td>
      <td>30.00</td>
      <td>2017-07-07</td>
      <td>1</td>
      <td>2.8</td>
      <td>5</td>
      <td>17.5</td>
      <td>4</td>
      <td>unknown</td>
      <td>...</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>413</td>
      <td>45000.000000</td>
      <td>4</td>
      <td>7</td>
      <td>2017</td>
      <td>2017-07-01</td>
      <td>other</td>
    </tr>
    <tr>
      <th>23693</th>
      <td>9</td>
      <td>4600000</td>
      <td>62.40</td>
      <td>2016-08-05</td>
      <td>3</td>
      <td>2.6</td>
      <td>9</td>
      <td>40.0</td>
      <td>8</td>
      <td>unknown</td>
      <td>...</td>
      <td>352.0</td>
      <td>1</td>
      <td>675.0</td>
      <td>239</td>
      <td>73717.948718</td>
      <td>4</td>
      <td>8</td>
      <td>2016</td>
      <td>2016-08-01</td>
      <td>other</td>
    </tr>
    <tr>
      <th>23695</th>
      <td>14</td>
      <td>3100000</td>
      <td>59.00</td>
      <td>2018-01-15</td>
      <td>3</td>
      <td>2.8</td>
      <td>5</td>
      <td>38.0</td>
      <td>4</td>
      <td>unknown</td>
      <td>...</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>45</td>
      <td>52542.372881</td>
      <td>0</td>
      <td>1</td>
      <td>2018</td>
      <td>2018-01-01</td>
      <td>other</td>
    </tr>
    <tr>
      <th>23697</th>
      <td>13</td>
      <td>11475000</td>
      <td>76.75</td>
      <td>2017-03-28</td>
      <td>2</td>
      <td>3.0</td>
      <td>17</td>
      <td>NaN</td>
      <td>12</td>
      <td>unknown</td>
      <td>...</td>
      <td>173.0</td>
      <td>3</td>
      <td>196.0</td>
      <td>602</td>
      <td>149511.400651</td>
      <td>1</td>
      <td>3</td>
      <td>2017</td>
      <td>2017-03-01</td>
      <td>other</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div></div></div>
</div>
<p>Let’s see if we can find the cause.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_with_days</span>
      <span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_with_days</span>
      <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;days_exposition == 45&#39;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/049e149178012f106b2563fb31b940c54fd416d9f64775f02b8edcbc57f7f740.png" src="_images/049e149178012f106b2563fb31b940c54fd416d9f64775f02b8edcbc57f7f740.png" />
<img alt="_images/7ce68dd2bc9b734c03fb91ee156f3b3a444bfea0a07bad6ef27fd1e6b92fedd1.png" src="_images/7ce68dd2bc9b734c03fb91ee156f3b3a444bfea0a07bad6ef27fd1e6b92fedd1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;last_price&#39;</span><span class="p">,</span> <span class="s1">&#39;first_day_exposition&#39;</span><span class="p">,</span> <span class="s1">&#39;one_meter_cost&#39;</span><span class="p">]:</span>
    <span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data_with_days</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> 
              <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> 
              <span class="n">label</span><span class="o">=</span><span class="s1">&#39;all_days&#39;</span><span class="p">))</span>
    <span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data_with_days</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;days_exposition == 45&#39;</span><span class="p">)[</span><span class="n">column</span><span class="p">],</span> 
              <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> 
              <span class="n">label</span><span class="o">=</span><span class="s1">&#39;45_days&#39;</span><span class="p">))</span>
    <span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data_with_days</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;days_exposition == 60&#39;</span><span class="p">)[</span><span class="n">column</span><span class="p">],</span> 
              <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> 
              <span class="n">label</span><span class="o">=</span><span class="s1">&#39;60_days&#39;</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4b3a928f4df18255431ba5cc67b1630a132871c15ed28a884669b0d30cee83e2.png" src="_images/4b3a928f4df18255431ba5cc67b1630a132871c15ed28a884669b0d30cee83e2.png" />
<img alt="_images/67c20db3db77402027b865ba9f03ea2a6c4cea56efad38cd3647d51c2599e1d4.png" src="_images/67c20db3db77402027b865ba9f03ea2a6c4cea56efad38cd3647d51c2599e1d4.png" />
<img alt="_images/b3cdb5fe62825a617bda1ba21ced2e4dd46e987b29528e18f849d9a2216d3a1f.png" src="_images/b3cdb5fe62825a617bda1ba21ced2e4dd46e987b29528e18f849d9a2216d3a1f.png" />
</div>
</div>
<p>The scale doesn’t allow for such a comparison.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;days_exposition&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    19360.000000
mean       176.491426
std        215.809028
min          1.000000
25%         44.000000
50%         93.000000
75%        224.000000
max       1580.000000
Name: days_exposition, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The arithmetic mean (176.5) is almost double the median (93), which tells us that most of the ads are recent.</p>
<p>If we look for the border between long-standing and recent announcements, we can put it either at 75% (day 224) or after 1000 days, since there are already outliers there.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;days_exposition&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2767
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span>
      <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;days_exposition&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
      <span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4c8be7a09cd604f80bc74161d737ecff92d2c0854ecdaf9853dbd4847c70c79c.png" src="_images/4c8be7a09cd604f80bc74161d737ecff92d2c0854ecdaf9853dbd4847c70c79c.png" />
</div>
</div>
<p>The skip distributions look similar to the main dataset.</p>
<p>I cannot find anything in the data that could explain this. This probably is a regulation from the platform on which the ads are published.</p>
</section>
</section>
<section id="factors-affecting-pricing">
<h2>Factors affecting pricing<a class="headerlink" href="#factors-affecting-pricing" title="Link to this heading">#</a></h2>
<p>Let’s plot the distribution of prices and look if it depends on the given factors. Here is the overall distribution:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;last_price&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20000000</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1aa93cb54db56af666fb89199b89b3a969bee5d928699e79fdf9a0f4840fc5db.png" src="_images/1aa93cb54db56af666fb89199b89b3a969bee5d928699e79fdf9a0f4840fc5db.png" />
</div>
</div>
<section id="price-on-total-area">
<h3>Price on total area<a class="headerlink" href="#price-on-total-area" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span> 
                <span class="n">x</span><span class="o">=</span><span class="s1">&#39;total_area&#39;</span><span class="p">,</span> 
                <span class="n">y</span><span class="o">=</span><span class="s1">&#39;last_price&#39;</span><span class="p">,</span> 
                <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8adb027377e0e91f830f5a68c2baaeb508ad28921e7b006ed6f90220a802cc20.png" src="_images/8adb027377e0e91f830f5a68c2baaeb508ad28921e7b006ed6f90220a802cc20.png" />
</div>
</div>
<p>Let’s try to estimate the density:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span>
      <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;total_area &lt; 100 &amp; last_price &lt; 10000000&#39;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hexbin&#39;</span><span class="p">,</span> 
            <span class="n">x</span><span class="o">=</span><span class="s1">&#39;total_area&#39;</span><span class="p">,</span> 
            <span class="n">y</span><span class="o">=</span><span class="s1">&#39;last_price&#39;</span><span class="p">,</span> 
            <span class="n">gridsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> 
            <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
            <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ff80e9f5a7fa33c6c41204e057af6acca0a0fe97835c2ae3873e24b8403e0dfa.png" src="_images/ff80e9f5a7fa33c6c41204e057af6acca0a0fe97835c2ae3873e24b8403e0dfa.png" />
</div>
</div>
<p>As you can see, the bulk of apartments cost about 4 million, for which the meterage vary from 30 to 50 meters. It is probably compensated by the location.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s calculate the Pearson correlation</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;last_price&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7468774416735338
</pre></div>
</div>
</div>
</div>
<p>There is definitely some positive correlation between price and total area.</p>
</section>
<section id="price-on-living-area">
<h3>Price on living area<a class="headerlink" href="#price-on-living-area" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span>
      <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;living_area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
      <span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/59780d337278e0b3856cce3b10152d6b3d1c9f36ab516d7be5b9d4df5c530dbc.png" src="_images/59780d337278e0b3856cce3b10152d6b3d1c9f36ab516d7be5b9d4df5c530dbc.png" />
</div>
</div>
<p>The gaps are similar to the main dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span>
      <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;living_area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span> <span class="c1"># We don&#39;t consider values missing in the living area column</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;living_area&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;last_price&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d36e853f270ad7a1df6629b597ff27e7e3e0b4691ae5d22e6328ad7966f5d518.png" src="_images/d36e853f270ad7a1df6629b597ff27e7e3e0b4691ae5d22e6328ad7966f5d518.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span>
      <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;living_area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
      <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;living_area &lt; 75 &amp; last_price &lt; 10000000&#39;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hexbin&#39;</span><span class="p">,</span> 
            <span class="n">x</span><span class="o">=</span><span class="s1">&#39;living_area&#39;</span><span class="p">,</span> 
            <span class="n">y</span><span class="o">=</span><span class="s1">&#39;last_price&#39;</span><span class="p">,</span> 
            <span class="n">gridsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> 
            <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
            <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/aceceaf4575da543959ad68681dd1661fd0b228b10d92e3d85cbf728cb5bbe95.png" src="_images/aceceaf4575da543959ad68681dd1661fd0b228b10d92e3d85cbf728cb5bbe95.png" />
</div>
</div>
<p>Seemingly, a categorization by number of rooms would be a good idea. Within these categories, the price varies slightly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;living_area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()][</span><span class="s1">&#39;total_area&#39;</span><span class="p">]</span>
 <span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;living_area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()][</span><span class="s1">&#39;last_price&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7515700261242726
</pre></div>
</div>
</div>
</div>
<p>Also a notable Pearson correlation.</p>
</section>
</section>
<section id="price-on-kitchen-area">
<h2>Price on kitchen area<a class="headerlink" href="#price-on-kitchen-area" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;kitchen_area&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;last_price&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2dea5cbde9895900761e7731f291289f1b6d462a295b0de0bbba30d23a0db25c.png" src="_images/2dea5cbde9895900761e7731f291289f1b6d462a295b0de0bbba30d23a0db25c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span>
      <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;kitchen_area &lt; 20 &amp; last_price &lt; 10000000&#39;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hexbin&#39;</span><span class="p">,</span> 
            <span class="n">x</span><span class="o">=</span><span class="s1">&#39;kitchen_area&#39;</span><span class="p">,</span> 
            <span class="n">y</span><span class="o">=</span><span class="s1">&#39;last_price&#39;</span><span class="p">,</span> 
            <span class="n">gridsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> 
            <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
            <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/051dce860bd1d554b4803b3e5a3edd4ff973b61389cec31cb0279a2c98047af9.png" src="_images/051dce860bd1d554b4803b3e5a3edd4ff973b61389cec31cb0279a2c98047af9.png" />
</div>
</div>
<p>Presumably kitchens are small everywhere, although there are slightly smaller and slightly larger kitchens. This has little effect on the price, as it significantly varies within the observed groups.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;kitchen_area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;last_price&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.508929761642737
</pre></div>
</div>
</div>
</div>
<p>The correlation is smaller. Apparently, there are more significant factors.</p>
<section id="price-on-the-number-of-rooms">
<h3>Price on the number of rooms<a class="headerlink" href="#price-on-the-number-of-rooms" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;rooms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    22127.000000
mean         1.981697
std          0.951304
min          0.000000
25%          1.000000
50%          2.000000
75%          3.000000
max          7.000000
Name: rooms, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_grouped_by_rooms</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;rooms&#39;</span><span class="p">)</span>
<span class="n">grouped_by_rooms_stat</span> <span class="o">=</span>  <span class="n">data_grouped_by_rooms</span><span class="p">[</span><span class="s1">&#39;last_price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">grouped_by_rooms_stat</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">grouped_by_rooms_stat</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4a23e374fd2bcbf21509d563c2e7c9a6c02a4ff358eb479037c3c80261c8fdf0.png" src="_images/4a23e374fd2bcbf21509d563c2e7c9a6c02a4ff358eb479037c3c80261c8fdf0.png" />
<img alt="_images/a0dba083cf1b7c43d742c1cb30424344858b06ea9a29ebfb4e42f532ac8d10d8.png" src="_images/a0dba083cf1b7c43d742c1cb30424344858b06ea9a29ebfb4e42f532ac8d10d8.png" />
<img alt="_images/bd1e59ff04f5acead8d87527a7b44ecdedbe99f468169594c0a331ad6c5217e8.png" src="_images/bd1e59ff04f5acead8d87527a7b44ecdedbe99f468169594c0a331ad6c5217e8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">grouped_by_rooms_stat</span>
 <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;rooms &lt;= 4&#39;</span><span class="p">)</span><span class="o">.</span>
 <span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;rooms&#39;&gt;
</pre></div>
</div>
<img alt="_images/d9c3bc43889dfec57582aabbbae7f0436015228984024108d89fa09bacd20bee.png" src="_images/d9c3bc43889dfec57582aabbbae7f0436015228984024108d89fa09bacd20bee.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">number_of_rooms</span><span class="p">,</span> <span class="n">grouped_data</span> <span class="ow">in</span> <span class="n">data_grouped_by_rooms</span><span class="p">:</span>
    <span class="p">(</span><span class="n">grouped_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> 
                       <span class="n">y</span><span class="o">=</span><span class="s1">&#39;last_price&#39;</span><span class="p">,</span> 
                       <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> 
                       <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">grouped_data</span><span class="p">[</span><span class="s1">&#39;last_price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)),</span> 
                       <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                       <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
                       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Number of rooms: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number_of_rooms</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e0b20e3d3b043fc824ebfdbe26078a401d3dfa094a577dbd029cd0d564a37f74.png" src="_images/e0b20e3d3b043fc824ebfdbe26078a401d3dfa094a577dbd029cd0d564a37f74.png" />
<img alt="_images/166b818a78756c2c488b327538a8a964112de79d9b1be69cdaf1bae71527b3e1.png" src="_images/166b818a78756c2c488b327538a8a964112de79d9b1be69cdaf1bae71527b3e1.png" />
<img alt="_images/d49385259c535c4a9349fd3bd7b5078dae5bc317f48ebabce62287c278ccbf80.png" src="_images/d49385259c535c4a9349fd3bd7b5078dae5bc317f48ebabce62287c278ccbf80.png" />
<img alt="_images/02f877dacc8e51cd2700eec957e8e88f3f77d9e91c8f305c633fddb2539b5bfd.png" src="_images/02f877dacc8e51cd2700eec957e8e88f3f77d9e91c8f305c633fddb2539b5bfd.png" />
<img alt="_images/20217051cc59e4b6a046627ca3e761c63317bca47da670f7bca572767aa3ffbd.png" src="_images/20217051cc59e4b6a046627ca3e761c63317bca47da670f7bca572767aa3ffbd.png" />
<img alt="_images/d84247e46f48e678d4cb93992620b652fd4ee48c1238ae80fc94a9914921ae28.png" src="_images/d84247e46f48e678d4cb93992620b652fd4ee48c1238ae80fc94a9914921ae28.png" />
<img alt="_images/eeb016233edb511b7b88d18ef4022e495e6c3924946c2797a2d5891377dfde99.png" src="_images/eeb016233edb511b7b88d18ef4022e495e6c3924946c2797a2d5891377dfde99.png" />
<img alt="_images/a05977cbd46956bc271ab4b4aaa62b702d909024db7605353963820df4dbd139.png" src="_images/a05977cbd46956bc271ab4b4aaa62b702d909024db7605353963820df4dbd139.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;rooms&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;last_price&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;rooms&#39;, ylabel=&#39;last_price&#39;&gt;
</pre></div>
</div>
<img alt="_images/73e887ad3828b8b4a8f3d9a8ecd0785138895af7af0217d28cc2cd257ff55c06.png" src="_images/73e887ad3828b8b4a8f3d9a8ecd0785138895af7af0217d28cc2cd257ff55c06.png" />
</div>
</div>
<p>The graphs definitely stand for a correlation.</p>
</section>
<section id="price-by-floor-location">
<h3>Price by floor location<a class="headerlink" href="#price-by-floor-location" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_grouped_by_floor</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;floor_type&#39;</span><span class="p">)</span>
<span class="n">grouped_by_floor_stat</span> <span class="o">=</span>  <span class="n">data_grouped_by_floor</span><span class="p">[</span><span class="s1">&#39;last_price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">grouped_by_floor_stat</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">grouped_by_floor_stat</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c31c0ad9341a807ea4eed3bc2324a70c93fa65e18ccf286615fe37d6ad3ed923.png" src="_images/c31c0ad9341a807ea4eed3bc2324a70c93fa65e18ccf286615fe37d6ad3ed923.png" />
<img alt="_images/fc59559467c50e9d7f486f9f621631c0f692e5b4e9b1aa015e04ab23c1aa2e52.png" src="_images/fc59559467c50e9d7f486f9f621631c0f692e5b4e9b1aa015e04ab23c1aa2e52.png" />
<img alt="_images/1361f0e62d0bb5106f18926c31365ba6840bfcb427b94b73d5d2954498f62585.png" src="_images/1361f0e62d0bb5106f18926c31365ba6840bfcb427b94b73d5d2954498f62585.png" />
</div>
</div>
<p>Which implies that the mean is heavily skewed by overpriced objects (which may be influenced by other factors like central location).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">floor_type</span><span class="p">,</span> <span class="n">grouped_data</span> <span class="ow">in</span> <span class="n">data_grouped_by_floor</span><span class="p">:</span>
    <span class="p">(</span><span class="n">grouped_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> 
                       <span class="n">y</span><span class="o">=</span><span class="s1">&#39;last_price&#39;</span><span class="p">,</span> 
                       <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> 
                       <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">grouped_data</span><span class="p">[</span><span class="s1">&#39;last_price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)),</span> 
                       <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                       <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
                       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Number of rooms: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">floor_type</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f8e2f727753cd9a337a5ebf0a74b26fb1eb455f8c90b5600a91e9816efd5a0ad.png" src="_images/f8e2f727753cd9a337a5ebf0a74b26fb1eb455f8c90b5600a91e9816efd5a0ad.png" />
<img alt="_images/0930ceab40d6e45b0ec36cbe7c7974127b57afa2eb6cc9efd170fb24441e2534.png" src="_images/0930ceab40d6e45b0ec36cbe7c7974127b57afa2eb6cc9efd170fb24441e2534.png" />
<img alt="_images/e1815076ec91d1df3ecf6a378578220793b65489996397ed6cbcbfa89df8fc1d.png" src="_images/e1815076ec91d1df3ecf6a378578220793b65489996397ed6cbcbfa89df8fc1d.png" />
</div>
</div>
</section>
<section id="price-and-time-of-placement">
<h3>Price and time of placement<a class="headerlink" href="#price-and-time-of-placement" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped_by_day_stat</span> <span class="o">=</span>  <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)[</span><span class="s1">&#39;last_price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">])</span>
<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">grouped_by_day_stat</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">grouped_by_day_stat</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5acfa3b39c0db64736a25feca25a97dcc9d5ca8717ddea8ed7729925fe179263.png" src="_images/5acfa3b39c0db64736a25feca25a97dcc9d5ca8717ddea8ed7729925fe179263.png" />
<img alt="_images/2e880832b5efe87339b9562d7156553471e8e5995d8ce117591242e5ade80008.png" src="_images/2e880832b5efe87339b9562d7156553471e8e5995d8ce117591242e5ade80008.png" />
<img alt="_images/ebb3c33078f7ef61610f75e06a457e8821de1e0641c9f9a4534a89a29c2d1789.png" src="_images/ebb3c33078f7ef61610f75e06a457e8821de1e0641c9f9a4534a89a29c2d1789.png" />
</div>
</div>
<p>Although there are fewer ads on weekends, the listed price is not affected.</p>
<p>The upward shift of the mean relative to the median is maintained steadily.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped_by_month_stat</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">)[</span><span class="s1">&#39;last_price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">])</span>
<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">grouped_by_month_stat</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">grouped_by_month_stat</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9c922c57b29c8d6aef480abce6977bfa6161b0807bffd86e504ff17a56737129.png" src="_images/9c922c57b29c8d6aef480abce6977bfa6161b0807bffd86e504ff17a56737129.png" />
<img alt="_images/2d3f43b30be0dbdb319234803ee2601e1505f275d706adc4c060dc0a55743202.png" src="_images/2d3f43b30be0dbdb319234803ee2601e1505f275d706adc4c060dc0a55743202.png" />
<img alt="_images/6cca441a4e30d2551a99e71acfde0ae19463192c5c70ddafec52b56f37d4ea94.png" src="_images/6cca441a4e30d2551a99e71acfde0ae19463192c5c70ddafec52b56f37d4ea94.png" />
</div>
</div>
<p>Similarly, the number of ads does not correlate with price.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped_by_year_stat</span> <span class="o">=</span>  <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)[</span><span class="s1">&#39;last_price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">])</span>
<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">grouped_by_year_stat</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">grouped_by_year_stat</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/69fbfe18621d26e181d079c569a4df1bb0d4235eb621ace18ce89ff84c63cc65.png" src="_images/69fbfe18621d26e181d079c569a4df1bb0d4235eb621ace18ce89ff84c63cc65.png" />
<img alt="_images/62e86a1d5fe89a299c594b272af299e7acb98a3d291d1ba10d2306c84d2c687e.png" src="_images/62e86a1d5fe89a299c594b272af299e7acb98a3d291d1ba10d2306c84d2c687e.png" />
<img alt="_images/ecf8895c29f5f808cc96b6ef5c9dfbb14c7295bc73a0e9c81a9d3447484ed2ae.png" src="_images/ecf8895c29f5f808cc96b6ef5c9dfbb14c7295bc73a0e9c81a9d3447484ed2ae.png" />
</div>
</div>
<p>Interesting data by year. We shall look more closely at the dates of coverage.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped_by_time_stat</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span>
                        <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;month_datetime64&#39;</span><span class="p">)[</span><span class="s1">&#39;last_price&#39;</span><span class="p">]</span>
                        <span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">]))</span>
<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">grouped_by_time_stat</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">grouped_by_time_stat</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fd2b487e88bc9d0968014f92dc839965ed5fdfa41c5b655deb39c428f746a1ea.png" src="_images/fd2b487e88bc9d0968014f92dc839965ed5fdfa41c5b655deb39c428f746a1ea.png" />
<img alt="_images/113f0b295002f27a140e416dab6cd3403c449676e9921fbb0966b0efe08ec98c.png" src="_images/113f0b295002f27a140e416dab6cd3403c449676e9921fbb0966b0efe08ec98c.png" />
<img alt="_images/cb4deb11d083d206b0c591aa3f38c6691b1b72683d64a9d7969c394e5ee7836d.png" src="_images/cb4deb11d083d206b0c591aa3f38c6691b1b72683d64a9d7969c394e5ee7836d.png" />
</div>
</div>
<p>Notably, 2019 was only half covered, 2014 was covered for a couple of months.</p>
<p>However, this does not explain the increased average cost in 2014, 2015 and 2019.
It can be explained by the fact that most of the apartments of that time (just the cheap ones) have already been bought.</p>
<p>Let’s look at the meterage of available apartments by year.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)[</span><span class="s1">&#39;total_area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;total_area&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;year&#39;&gt;
</pre></div>
</div>
<img alt="_images/85f9cea49ef7f8cadf37ed75df698c0f3f689e3dfe61271190a8348e020a5a1a.png" src="_images/85f9cea49ef7f8cadf37ed75df698c0f3f689e3dfe61271190a8348e020a5a1a.png" />
</div>
</div>
<p>The mean meterage was actually higher. There were no skips in this column, so these are the raw numbers. It would be good to find out how the late 2014 sample was formed.</p>
<p>Maybe everything cheap has already been bought up?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">data</span>
 <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;last_price&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;last_price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.99</span><span class="p">)]</span>
 <span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;month_datetime64&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;total_area&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">)</span>
 <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;month_datetime64&#39;&gt;
</pre></div>
</div>
<img alt="_images/6bbacf6e29c581ea66f5b0f525a770ea92a7ed394c4c469fac3eb2fb14ddbaef.png" src="_images/6bbacf6e29c581ea66f5b0f525a770ea92a7ed394c4c469fac3eb2fb14ddbaef.png" />
</div>
</div>
<p>I can’t imagine what could have caused such a drop in summer 2015. Maybe the crisis of 2014 had some impact?</p>
<p>Generally speaking, there were about a hundred applications for June 2015, so maybe it’s a coincidence.</p>
<p>I don’t know what else could explain these fluctuations on the graphs.</p>
</section>
<section id="price-and-period-of-exposition">
<h3>Price and period of exposition<a class="headerlink" href="#price-and-period-of-exposition" title="Link to this heading">#</a></h3>
<p>Let’s try to figure out if the price goes down over time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span>
      <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;days_exposition&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
      <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;locality_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;St. Petersburg&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;one_meter_cost&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;one_meter_cost&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.99</span><span class="p">)]</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;days_exposition&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;one_meter_cost&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5d7542e52881a9953658f31604479cca02ff115b63693750a67347e205b01fdb.png" src="_images/5d7542e52881a9953658f31604479cca02ff115b63693750a67347e205b01fdb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span>
      <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;days_exposition&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
      <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;locality_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;St. Petersburg&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;60000 &lt;= one_meter_cost &lt;= 180000&#39;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;days_exposition&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">250</span><span class="p">]</span>
      <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hexbin&#39;</span><span class="p">,</span> 
            <span class="n">x</span><span class="o">=</span><span class="s1">&#39;days_exposition&#39;</span><span class="p">,</span> 
            <span class="n">y</span><span class="o">=</span><span class="s1">&#39;one_meter_cost&#39;</span><span class="p">,</span> 
            <span class="n">gridsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> 
            <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
            <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0205123dc31b2ea4ef0c3a8a2bc9aa3261d09ca0b9e030b155618933738a24f5.png" src="_images/0205123dc31b2ea4ef0c3a8a2bc9aa3261d09ca0b9e030b155618933738a24f5.png" />
</div>
</div>
<p>Such graphs should, of course, be constructed according to the categories of prestige of apartments. Let’s take the number of rooms among apartments in St. Petersburg as the simplest one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">number_of_rooms</span><span class="p">,</span> <span class="n">grouped_data</span> <span class="ow">in</span> <span class="n">data_grouped_by_rooms</span><span class="p">:</span>
    <span class="p">(</span><span class="n">grouped_data</span>
     <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">grouped_data</span><span class="p">[</span><span class="s1">&#39;days_exposition&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
     <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">grouped_data</span><span class="p">[</span><span class="s1">&#39;locality_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;St. Petersburg&#39;</span><span class="p">]</span>
     <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">grouped_data</span><span class="p">[</span><span class="s1">&#39;one_meter_cost&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">grouped_data</span><span class="p">[</span><span class="s1">&#39;one_meter_cost&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.99</span><span class="p">)]</span>
     <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span> 
           <span class="n">x</span><span class="o">=</span><span class="s1">&#39;days_exposition&#39;</span><span class="p">,</span> 
           <span class="n">y</span><span class="o">=</span><span class="s1">&#39;one_meter_cost&#39;</span><span class="p">,</span> 
           <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
           <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
           <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Number of rooms: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number_of_rooms</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5883247c441950e4a24a5b7d2baa64f22f8a0a292e2e1e577cc44864f02a0819.png" src="_images/5883247c441950e4a24a5b7d2baa64f22f8a0a292e2e1e577cc44864f02a0819.png" />
<img alt="_images/b81195a8131ca734e5bb5a8cb37f30c38cd45c64ca85784a5b4926eb752a5480.png" src="_images/b81195a8131ca734e5bb5a8cb37f30c38cd45c64ca85784a5b4926eb752a5480.png" />
<img alt="_images/587a411a30d8c4d70066addf3e5ab1148dceb2485834c366fef0aa3d33415105.png" src="_images/587a411a30d8c4d70066addf3e5ab1148dceb2485834c366fef0aa3d33415105.png" />
<img alt="_images/d6e283fbe1a127d470911fe7c14fec4146ca9b5dc4eb6abe52dad33f822e9e1c.png" src="_images/d6e283fbe1a127d470911fe7c14fec4146ca9b5dc4eb6abe52dad33f822e9e1c.png" />
<img alt="_images/3a76ebac5ef6dab4c0d05c65f46d19199b20b14f4adb36fadf74c748b579d794.png" src="_images/3a76ebac5ef6dab4c0d05c65f46d19199b20b14f4adb36fadf74c748b579d794.png" />
<img alt="_images/16f42d54a22e5138481b9025ab41df7f003647fa15078cc6354cef25d9e51f39.png" src="_images/16f42d54a22e5138481b9025ab41df7f003647fa15078cc6354cef25d9e51f39.png" />
<img alt="_images/6d516c7d8ed11d2e8abc46653444ee85dd98415ab1bab577f2f669232bc55e65.png" src="_images/6d516c7d8ed11d2e8abc46653444ee85dd98415ab1bab577f2f669232bc55e65.png" />
<img alt="_images/79408413ee0e231eba2de254a1fac94f2658995454f35d1432d7087ce3e3f8d1.png" src="_images/79408413ee0e231eba2de254a1fac94f2658995454f35d1432d7087ce3e3f8d1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">number_of_rooms</span><span class="p">,</span> <span class="n">grouped_data</span> <span class="ow">in</span> <span class="n">data_grouped_by_rooms</span><span class="p">:</span>
    <span class="n">current_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">grouped_data</span>
                    <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">grouped_data</span><span class="p">[</span><span class="s1">&#39;days_exposition&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
                    <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">grouped_data</span><span class="p">[</span><span class="s1">&#39;locality_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;St. Petersburg&#39;</span><span class="p">]</span>
                    <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">grouped_data</span><span class="p">[</span><span class="s1">&#39;one_meter_cost&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">grouped_data</span><span class="p">[</span><span class="s1">&#39;one_meter_cost&#39;</span><span class="p">]</span>
                         <span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.99</span><span class="p">)])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Correlation for </span><span class="si">{}</span><span class="s1"> rooms: &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number_of_rooms</span><span class="p">),</span> 
          <span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;days_exposition&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">current_data</span><span class="p">[</span><span class="s1">&#39;one_meter_cost&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Correlation for 0 rooms:  0.03892893984208547
Correlation for 1 rooms:  0.08912057316333274
Correlation for 2 rooms:  0.05347179799535866
Correlation for 3 rooms:  0.027741392022893656
Correlation for 4 rooms:  0.0025995493266276655
Correlation for 5 rooms:  -0.025114060168205173
Correlation for 6 rooms:  0.2589598326174999
Correlation for 7 rooms:  0.09408577015939108
</pre></div>
</div>
</div>
</div>
<p>Correlation hasn’t confirmed anything, but I’m not sure it’s appropriate to apply it here either.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_days_exposition_type</span><span class="p">(</span><span class="n">days</span><span class="p">):</span>
    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">days</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="mi">101</span> <span class="o">&lt;=</span> <span class="n">days</span> <span class="o">&lt;=</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="mi">201</span> <span class="o">&lt;=</span> <span class="n">days</span> <span class="o">&lt;=</span> <span class="mi">300</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="mi">301</span> <span class="o">&lt;=</span> <span class="n">days</span> <span class="o">&lt;=</span> <span class="mi">400</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">3</span>
    <span class="k">elif</span> <span class="mi">401</span> <span class="o">&lt;=</span> <span class="n">days</span> <span class="o">&lt;=</span> <span class="mi">500</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">4</span>
    <span class="k">elif</span> <span class="mi">501</span> <span class="o">&lt;=</span> <span class="n">days</span> <span class="o">&lt;=</span> <span class="mi">600</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">5</span>
    <span class="k">elif</span> <span class="mi">601</span> <span class="o">&lt;=</span> <span class="n">days</span> <span class="o">&lt;=</span> <span class="mi">700</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">6</span>
    <span class="k">elif</span> <span class="mi">701</span> <span class="o">&lt;=</span> <span class="n">days</span> <span class="o">&lt;=</span> <span class="mi">800</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">7</span>
    <span class="k">elif</span> <span class="mi">801</span> <span class="o">&lt;=</span> <span class="n">days</span> <span class="o">&lt;=</span> <span class="mi">900</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">8</span>
    <span class="k">elif</span> <span class="mi">901</span> <span class="o">&lt;=</span> <span class="n">days</span> <span class="o">&lt;=</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">9</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;days_exposition_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;days_exposition&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_days_exposition_type</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">data</span>
 <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;days_exposition_type&#39;</span><span class="p">)[</span><span class="s1">&#39;one_meter_cost&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
 <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;one_meter_cost&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;days_exposition_type&#39;&gt;
</pre></div>
</div>
<img alt="_images/c83fabdd9d75fc9586285593ae4c650639aebcc6b0b3ba5badd468a06956f5d0.png" src="_images/c83fabdd9d75fc9586285593ae4c650639aebcc6b0b3ba5badd468a06956f5d0.png" />
</div>
</div>
<p>In general, the charts do not show any signs of price decline over time. It is more likely that cheap real estate is being bought up.</p>
</section>
</section>
<section id="average-price-per-square-meter">
<h2>Average price per square meter<a class="headerlink" href="#average-price-per-square-meter" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;total_images&#39;, &#39;last_price&#39;, &#39;total_area&#39;, &#39;first_day_exposition&#39;,
       &#39;rooms&#39;, &#39;ceiling_height&#39;, &#39;floors_total&#39;, &#39;living_area&#39;, &#39;floor&#39;,
       &#39;is_apartment&#39;, &#39;studio&#39;, &#39;open_plan&#39;, &#39;kitchen_area&#39;, &#39;balcony&#39;,
       &#39;locality_name&#39;, &#39;airports_nearest&#39;, &#39;cityCenters_nearest&#39;,
       &#39;parks_around3000&#39;, &#39;parks_nearest&#39;, &#39;ponds_around3000&#39;,
       &#39;ponds_nearest&#39;, &#39;days_exposition&#39;, &#39;one_meter_cost&#39;, &#39;day&#39;, &#39;month&#39;,
       &#39;year&#39;, &#39;month_datetime64&#39;, &#39;floor_type&#39;, &#39;days_exposition_type&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Let’s select 10 localities with the largest number of announcements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">top_list</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;locality_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">top_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>St. Petersburg          14495
Murino settlement         586
Kudrovo settlement        470
Shushary settlement       439
Vsevolozhsk               396
Pushkin                   351
Kolpino                   337
Pargolovo settlement      327
Gatchina                  306
Vyborg                    232
Name: locality_name, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">data</span>
 <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;locality_name in @top_list.index&#39;</span><span class="p">)</span>
 <span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;locality_name&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;one_meter_cost&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">])</span>
 <span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>median</th>
    </tr>
    <tr>
      <th>locality_name</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Gatchina</th>
      <td>68935.194838</td>
      <td>67860.569236</td>
    </tr>
    <tr>
      <th>Kolpino</th>
      <td>75333.295801</td>
      <td>74722.222222</td>
    </tr>
    <tr>
      <th>Kudrovo settlement</th>
      <td>95260.846171</td>
      <td>95555.311677</td>
    </tr>
    <tr>
      <th>Murino settlement</th>
      <td>86041.116064</td>
      <td>86250.377687</td>
    </tr>
    <tr>
      <th>Pargolovo settlement</th>
      <td>90175.913458</td>
      <td>91642.857143</td>
    </tr>
    <tr>
      <th>Pushkin</th>
      <td>101197.271132</td>
      <td>99431.818182</td>
    </tr>
    <tr>
      <th>Shushary settlement</th>
      <td>78551.344545</td>
      <td>76829.268293</td>
    </tr>
    <tr>
      <th>St. Petersburg</th>
      <td>107259.375907</td>
      <td>102857.142857</td>
    </tr>
    <tr>
      <th>Vsevolozhsk</th>
      <td>67275.592779</td>
      <td>65789.473684</td>
    </tr>
    <tr>
      <th>Vyborg</th>
      <td>58475.378303</td>
      <td>58357.385977</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">data</span>
 <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;locality_name in @top_list.index&#39;</span><span class="p">)</span>
 <span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;locality_name&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;one_meter_cost&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">])</span>
 <span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
 <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;locality_name&#39;&gt;
</pre></div>
</div>
<img alt="_images/4db6f9abc0c6dee83ae121939c7fde6862b53ec624a0749b6a725dc977a75bf7.png" src="_images/4db6f9abc0c6dee83ae121939c7fde6862b53ec624a0749b6a725dc977a75bf7.png" />
</div>
</div>
<p>This way or that way, St. Petersburg is in first place and Vyborg is in last place.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;locality_name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;balcony&#39;</span><span class="p">:</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;last_price&#39;</span><span class="p">:</span><span class="s1">&#39;median&#39;</span><span class="p">})</span> \
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;balcony&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>balcony</th>
      <th>last_price</th>
    </tr>
    <tr>
      <th>locality_name</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>St. Petersburg</th>
      <td>14495</td>
      <td>5300000.0</td>
    </tr>
    <tr>
      <th>Murino settlement</th>
      <td>586</td>
      <td>3400000.0</td>
    </tr>
    <tr>
      <th>Kudrovo settlement</th>
      <td>470</td>
      <td>3887500.0</td>
    </tr>
    <tr>
      <th>Shushary settlement</th>
      <td>439</td>
      <td>3950000.0</td>
    </tr>
    <tr>
      <th>Vsevolozhsk</th>
      <td>396</td>
      <td>3450000.0</td>
    </tr>
    <tr>
      <th>Pushkin</th>
      <td>351</td>
      <td>5100000.0</td>
    </tr>
    <tr>
      <th>Kolpino</th>
      <td>337</td>
      <td>3600000.0</td>
    </tr>
    <tr>
      <th>Pargolovo settlement</th>
      <td>327</td>
      <td>4100000.0</td>
    </tr>
    <tr>
      <th>Gatchina</th>
      <td>306</td>
      <td>3100000.0</td>
    </tr>
    <tr>
      <th>Vyborg</th>
      <td>232</td>
      <td>2900000.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="price-on-distance-to-the-center">
<h2>Price on distance to the center<a class="headerlink" href="#price-on-distance-to-the-center" title="Link to this heading">#</a></h2>
<p>Let’s have a look at apartments in St. Petersburg.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spb</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;locality_name == &quot;St. Petersburg&quot;&#39;</span><span class="p">)</span>
<span class="n">spb</span><span class="p">[</span><span class="s1">&#39;cityCenters_nearest&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    14495.000000
mean        11.978337
std          4.685067
min          0.000000
25%          9.000000
50%         13.000000
75%         15.000000
max         29.000000
Name: cityCenters_nearest, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">spb</span><span class="p">[</span><span class="s1">&#39;cityCenters_nearest&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spb</span><span class="p">[</span><span class="s1">&#39;cityCenters_nearest&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">spb</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>total_images               0
last_price                 0
total_area                 0
first_day_exposition       0
rooms                      0
ceiling_height             0
floors_total               0
living_area              980
floor                      0
is_apartment               0
studio                     0
open_plan                  0
kitchen_area               0
balcony                    0
locality_name              0
airports_nearest           0
cityCenters_nearest        0
parks_around3000           0
parks_nearest              0
ponds_around3000           0
ponds_nearest              0
days_exposition         1732
one_meter_cost             0
day                        0
month                      0
year                       0
month_datetime64           0
floor_type                 0
days_exposition_type       0
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Let’s group the prices of one square meter of real estate by rounded kilometers to the center.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spb_stat</span> <span class="o">=</span> <span class="p">(</span><span class="n">spb</span>
            <span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;cityCenters_nearest&#39;</span><span class="p">,</span> 
                         <span class="n">values</span><span class="o">=</span><span class="s1">&#39;one_meter_cost&#39;</span><span class="p">,</span> 
                         <span class="n">aggfunc</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">])</span>
            <span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">spb_stat</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>median</th>
    </tr>
    <tr>
      <th>cityCenters_nearest</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>13</td>
      <td>118752.879316</td>
      <td>108163.265306</td>
    </tr>
    <tr>
      <th>1</th>
      <td>130</td>
      <td>123133.496942</td>
      <td>114600.313480</td>
    </tr>
    <tr>
      <th>2</th>
      <td>229</td>
      <td>120789.304090</td>
      <td>114000.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>295</td>
      <td>110997.430929</td>
      <td>105263.157895</td>
    </tr>
    <tr>
      <th>4</th>
      <td>561</td>
      <td>117780.941585</td>
      <td>110869.565217</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spb_stat</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;cityCenters_nearest&#39;&gt;
</pre></div>
</div>
<img alt="_images/cef5bbb24893ea053dd042bd1b7456ee43da234669735d0a4d98a8264a72ce67.png" src="_images/cef5bbb24893ea053dd042bd1b7456ee43da234669735d0a4d98a8264a72ce67.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spb_stat</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Distribution by distance&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/88920d71fe52e2253c3a3eb94a55394d00d6f3a85f8c15bcbfe491618ea9fb7b.png" src="_images/88920d71fe52e2253c3a3eb94a55394d00d6f3a85f8c15bcbfe491618ea9fb7b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">raw_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;locality_name == &quot;St. Petersburg&quot; and cityCenters_nearest &lt;= 1000&#39;</span><span class="p">)</span>
 <span class="p">[</span><span class="s1">&#39;cityCenters_nearest&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13694    181.0
1182     208.0
8614     215.0
1934     287.0
20873    291.0
         ...  
14837    959.0
19904    964.0
3442     964.0
15856    993.0
7467     996.0
Name: cityCenters_nearest, Length: 86, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>I wanted to make sure there were no absolute zeros.</p>
<p>It turns out that the median price per square meter does fall with distance from the city center.</p>
<p>It falls, in my opinion, slower than expected. I thought that as we get closer to the city center there will be almost exponential growth, however, we got only 1.5 times higher than 10 kilometers from the center.</p>
<p>The dip around 3 kilometers from the city center is interesting. Maybe there are few stores, schools or any other necessary facilities for living at such a distance?</p>
</section>
<section id="conclusions">
<h2>Conclusions<a class="headerlink" href="#conclusions" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Data specifications</p></li>
</ol>
<ul class="simple">
<li><p>Some values sellers do not indicate. These include the number of balconies, ceiling height and the fact that the property belongs to the apartment class.</p></li>
<li><p>Some sellers may not provide the exact location of the apartment. This is especially common in small settlements like villages. In this case, the system cannot estimate the distance to the center, parks and water bodies.</p></li>
<li><p>The data cover the period from the end of 2014 to the middle of 2019. Year-to-year statistics are highly heterogeneous; for example, for the end of 2014, the meterage and price are noticeably higher than average.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>Pricing</p></li>
</ol>
<ul class="simple">
<li><p>Most of the apartments consist of 1, 2 or 3 rooms. The price directly depends on the number of rooms.</p></li>
<li><p>The correlation between the meter size of the apartment and its price is precisely traceable. For small apartments (about 50 square meters) there are quite firm limits in the region of 4 millions. For larger apartments, a seller can ask for a wide range of sums.</p></li>
<li><p>The first and last floors are not as popular as other floors, which is reflected in the prices.</p></li>
<li><p>Neither the day nor the month of listing affects the price of the apartment.</p></li>
<li><p>There is a connection between the distance to the center of St. Petersburg and the price of real estate, but it is rather smooth: so the cost of an apartment in the very center is 1.5 times higher than an apartment 10 kilometers away from it.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Mean values</p></li>
</ol>
<ul class="simple">
<li><p>The predominant building in the Leningrad Oblast is a five-story building. It is on the first 5 floors of the buildings that most ads are placed. The next most common building is a 9-storey building.</p></li>
<li><p>The average price per square meter is the highest in St. Petersburg, then in Pushkin and further in the “settlements” up to Vyborg on the 10th place out of more than 300 places.</p></li>
<li><p>Most often advertisements are published in the first half of spring or in the fall.</p></li>
<li><p>Among apartments in St. Petersburg, the average distance to the center is about 12 kilometers.</p></li>
</ul>
<ol class="arabic simple" start="4">
<li><p>Notable details</p></li>
</ol>
<ul class="simple">
<li><p>The number of listings falls asymptotically over time – either demand is constant or supply goes up over time. Especially many ads disappear on days 45 and 60.</p></li>
<li><p>The distribution of living space has two clear peaks. By this awy, dependence on the number of rooms is possible. Apparently, the range of the area of one room is not so large in the Leningrad Oblast.</p></li>
<li><p>On weekends sellers give fewer real estate ads. There could be many real estate agents working on the market.</p></li>
<li><p>Across the entire sample, the mean value is shifted upward relative to the median. Apparently, the price is often inflated.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="credit_scoring.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Credit scoring</p>
      </div>
    </a>
    <a class="right-next"
       href="tariff_stats.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tariff statistics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preprocessing">Data preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-description">Data description</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-values">Missing values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-data-types">Changing data types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#duplicates">Duplicates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#troubleshooting-abnormal-values">Troubleshooting abnormal values</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-categorization">Data categorization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploratory-data-analysis">Exploratory data analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meters">Meters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#price-of-the-object">Price of the object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#number-of-rooms">Number of rooms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ceiling-height">Ceiling height</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#apartment-floor">Apartment Floor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distances-to-objects">Distances to objects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advertisement-publication-date">Advertisement Publication Date</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#days-of-exposition">Days of exposition</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factors-affecting-pricing">Factors affecting pricing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#price-on-total-area">Price on total area</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#price-on-living-area">Price on living area</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#price-on-kitchen-area">Price on kitchen area</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#price-on-the-number-of-rooms">Price on the number of rooms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#price-by-floor-location">Price by floor location</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#price-and-time-of-placement">Price and time of placement</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#price-and-period-of-exposition">Price and period of exposition</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#average-price-per-square-meter">Average price per square meter</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#price-on-distance-to-the-center">Price on distance to the center</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">Conclusions</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Leonid Dybovskii
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>